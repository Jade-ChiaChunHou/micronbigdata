{"paragraphs":[{"text":"%pyspark \ndata = [1,2,3,4,5]\nrdd = sc.parallelize(data, 4)\nrdd.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:27:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1552440396492_-1465205978","id":"20190313-012636_2143824384","dateCreated":"2019-03-13T01:26:36+0000","dateStarted":"2019-03-13T01:27:06+0000","dateFinished":"2019-03-13T01:27:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1579"},{"text":"%pyspark\nlines = sc.textFile('file:/tmp/cnn.txt')\nlines\nlines.take(3)\n","user":"anonymous","dateUpdated":"2019-03-13T01:31:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[' (CNN)Hundreds of thousands of people have been evacuated in the central Philippines, where a fierce storm is lashing coastal areas with heavy wind and rain.', '', 'Typhoon Melor has killed at least one person, caused power cuts and disrupted transportation after churning across several islands in the archipelago since Monday.']\n"}]},"apps":[],"jobName":"paragraph_1552440426298_-1078887434","id":"20190313-012706_461298469","dateCreated":"2019-03-13T01:27:06+0000","dateStarted":"2019-03-13T01:31:55+0000","dateFinished":"2019-03-13T01:31:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1580"},{"text":"%python\ndef addnum(a,b):\n    return a + b\n    \naddnum(3,5)\n","user":"anonymous","dateUpdated":"2019-03-13T01:35:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"8\n"}]},"apps":[],"jobName":"paragraph_1552440647396_-359100507","id":"20190313-013047_2056815560","dateCreated":"2019-03-13T01:30:47+0000","dateStarted":"2019-03-13T01:35:32+0000","dateFinished":"2019-03-13T01:35:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1581"},{"text":"%python\nf = lambda a,b: a + b\nf(5,6)","user":"anonymous","dateUpdated":"2019-03-13T01:36:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"11\n"}]},"apps":[],"jobName":"paragraph_1552440932848_1115083255","id":"20190313-013532_352308924","dateCreated":"2019-03-13T01:35:32+0000","dateStarted":"2019-03-13T01:36:29+0000","dateFinished":"2019-03-13T01:36:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1582"},{"text":"%pyspark\nrdd = sc.parallelize([1, 2, 3, 4])\nrdd2 = rdd.map(lambda x: x * 2)\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-03-13T01:40:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 8]\n"}]},"apps":[],"jobName":"paragraph_1552440984807_848360322","id":"20190313-013624_1841736493","dateCreated":"2019-03-13T01:36:24+0000","dateStarted":"2019-03-13T01:40:11+0000","dateFinished":"2019-03-13T01:40:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1583"},{"text":"%pyspark\nrdd2 = rdd.filter(lambda x: x%2 == 0)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:40:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4]\n"}]},"apps":[],"jobName":"paragraph_1552441146919_1015188103","id":"20190313-013906_328500943","dateCreated":"2019-03-13T01:39:06+0000","dateStarted":"2019-03-13T01:40:40+0000","dateFinished":"2019-03-13T01:40:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1584"},{"text":"%pyspark\nrdd = sc.parallelize([1,4,2,2,3])\nrdd2 = rdd.distinct()\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:41:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4]\n"}]},"apps":[],"jobName":"paragraph_1552441240248_-1356298492","id":"20190313-014040_269402105","dateCreated":"2019-03-13T01:40:40+0000","dateStarted":"2019-03-13T01:41:28+0000","dateFinished":"2019-03-13T01:41:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1585"},{"text":"%pyspark\nrdd =  sc.parallelize([1,2,3])\nrdd2 = rdd.map(lambda x: [x, x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:42:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 6], [2, 7], [3, 8]]\n"}]},"apps":[],"jobName":"paragraph_1552441276379_-598297186","id":"20190313-014116_1117739274","dateCreated":"2019-03-13T01:41:16+0000","dateStarted":"2019-03-13T01:42:32+0000","dateFinished":"2019-03-13T01:42:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1586"},{"text":"%pyspark\nrdd2 = rdd.flatMap(lambda x: [x, x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:42:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 6, 2, 7, 3, 8]\n"}]},"apps":[],"jobName":"paragraph_1552441352367_-1055624067","id":"20190313-014232_2062643427","dateCreated":"2019-03-13T01:42:32+0000","dateStarted":"2019-03-13T01:42:57+0000","dateFinished":"2019-03-13T01:42:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1587"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.reduce(lambda a,b:a*b)\n","user":"anonymous","dateUpdated":"2019-03-13T02:07:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552441377788_-2038626858","id":"20190313-014257_268211193","dateCreated":"2019-03-13T01:42:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1588","dateFinished":"2019-03-13T02:07:53+0000","dateStarted":"2019-03-13T02:07:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"6\n"}]}},{"text":"%pyspark\nrdd.take(2)","user":"anonymous","dateUpdated":"2019-03-13T02:08:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552442867041_-1787684684","id":"20190313-020747_1573901740","dateCreated":"2019-03-13T02:07:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2291","dateFinished":"2019-03-13T02:08:09+0000","dateStarted":"2019-03-13T02:08:09+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2]\n"}]}},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-03-13T02:08:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552442889277_781329694","id":"20190313-020809_210288788","dateCreated":"2019-03-13T02:08:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2391","dateFinished":"2019-03-13T02:08:18+0000","dateStarted":"2019-03-13T02:08:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]}},{"text":"%pyspark\nrdd=sc.parallelize([5,3,1,2])\nrdd.takeOrdered(3,lambda s:-1*s)\n","user":"anonymous","dateUpdated":"2019-03-13T02:08:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552442898152_1747834255","id":"20190313-020818_2133166708","dateCreated":"2019-03-13T02:08:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2472","dateFinished":"2019-03-13T02:08:55+0000","dateStarted":"2019-03-13T02:08:55+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 3, 2]\n"}]}},{"text":"%pyspark\nrdd = sc.parallelize([(1,2),(3,4),(3,6)])\nrdd2 = rdd.reduceByKey(lambda a, b: a + b)  \nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-03-13T02:15:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552442935738_1991642465","id":"20190313-020855_1942651080","dateCreated":"2019-03-13T02:08:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2544","dateFinished":"2019-03-13T02:15:31+0000","dateStarted":"2019-03-13T02:15:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 10)]\n"}]}},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd3 = rdd2.sortByKey()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-03-13T02:16:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552443320720_1540263606","id":"20190313-021520_1334525823","dateCreated":"2019-03-13T02:15:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2634","dateFinished":"2019-03-13T02:16:15+0000","dateStarted":"2019-03-13T02:16:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"}]}},{"text":"%pyspark\nbroadcastVar = sc.broadcast([1, 2, 3]) \nbroadcastVar.value","user":"anonymous","dateUpdated":"2019-03-13T02:22:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552443375236_687721340","id":"20190313-021615_892971271","dateCreated":"2019-03-13T02:16:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2731","dateFinished":"2019-03-13T02:22:08+0000","dateStarted":"2019-03-13T02:22:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]}},{"text":"%pyspark\naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n    global accum\n    accum += x  \n \nrdd.foreach(f) \naccum.value\n","user":"anonymous","dateUpdated":"2019-03-13T02:24:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552443728187_-210914173","id":"20190313-022208_621320289","dateCreated":"2019-03-13T02:22:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2812","dateFinished":"2019-03-13T02:24:54+0000","dateStarted":"2019-03-13T02:24:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]}},{"text":"%pyspark\nlines = sc.textFile('file:/tmp/cnn.txt')\nrdd  =   lines.flatMap(lambda line: line.split()).map(lambda e: (e, 1)).reduceByKey(lambda a,b: a+b).sortBy(lambda a: -a[1])\nrdd.take(5)","user":"anonymous","dateUpdated":"2019-03-13T02:34:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552443894658_-249191493","id":"20190313-022454_1678869261","dateCreated":"2019-03-13T02:24:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2884","dateFinished":"2019-03-13T02:34:50+0000","dateStarted":"2019-03-13T02:34:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('the', 18), ('of', 10), ('in', 9), ('to', 6), ('a', 5)]\n"}]}},{"text":"%pyspark \nlines = sc.textFile('file:///tmp/u.data')\nlines.take(3)\nmovies = lines.map(lambda e : (e.split()[1], 1) )\nmovieCounts = movies.reduceByKey(lambda x,y: x+y)\nmovieCounts.take(3)\nres = movieCounts.sortBy(lambda a: -a[1])\nres.take(3)\n","user":"anonymous","dateUpdated":"2019-03-13T02:43:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552444214258_818550170","id":"20190313-023014_250150485","dateCreated":"2019-03-13T02:30:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2968","dateFinished":"2019-03-13T02:43:36+0000","dateStarted":"2019-03-13T02:43:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('50', 583), ('258', 509), ('100', 508)]\n"}]}},{"text":"%python\ns = '196\\t242\\t3\\t881250949'\ns.split()","user":"anonymous","dateUpdated":"2019-03-13T02:41:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552444746238_-1996706794","id":"20190313-023906_512550432","dateCreated":"2019-03-13T02:39:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3240","dateFinished":"2019-03-13T02:41:47+0000","dateStarted":"2019-03-13T02:41:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'242'\n"}]}},{"text":"%python\ndic = {}\nwith open('/tmp/u.item', encoding = 'latin1') as f:\n    for line in f:\n        ele =line.split('|')\n        dic[ele[0]] = ele[1]\n#dic\n","user":"anonymous","dateUpdated":"2019-03-13T03:11:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552444896087_-1229134383","id":"20190313-024136_527288480","dateCreated":"2019-03-13T02:41:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3354","dateFinished":"2019-03-13T03:11:50+0000","dateStarted":"2019-03-13T03:11:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\ndef loadMovieNames():\n    movieNames = {}\n    with open('/tmp/u.item', encoding = 'latin1') as f:\n        for line in f:\n            ele =line.split('|')\n            movieNames[ele[0]] = ele[1]\n    return movieNames\nnamedict= sc.broadcast(loadMovieNames())\n","user":"anonymous","dateUpdated":"2019-03-13T03:11:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552446223341_-1343784327","id":"20190313-030343_370283773","dateCreated":"2019-03-13T03:03:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3523","dateFinished":"2019-03-13T03:11:17+0000","dateStarted":"2019-03-13T03:11:17+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nlines = sc.textFile('file:///tmp/u.data')\nmovies = lines.map(lambda e : (e.split()[1], 1) )\nmovieCounts = movies.reduceByKey(lambda x,y: x+y)\nres = movieCounts.sortBy(lambda a: -a[1])\nres2 = res.map(lambda e: (namedict.value.get(e[0]), e[1]) )\nres2.take(10)","user":"anonymous","dateUpdated":"2019-03-13T03:13:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552446666351_823148838","id":"20190313-031106_1128030066","dateCreated":"2019-03-13T03:11:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3901","dateFinished":"2019-03-13T03:13:24+0000","dateStarted":"2019-03-13T03:13:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Star Wars (1977)', 583), ('Contact (1997)', 509), ('Fargo (1996)', 508), ('Return of the Jedi (1983)', 507), ('Liar Liar (1997)', 485), ('English Patient, The (1996)', 481), ('Scream (1996)', 478), ('Toy Story (1995)', 452), ('Air Force One (1997)', 431), ('Independence Day (ID4) (1996)', 429)]\n"}]}},{"text":"%python \nimport pandas\ndf = pandas.DataFrame([['Mary',23, 10000], ['John',32, 20000], ['Joe',35, 50000]])\ndf.columns = ['name', 'age', 'salary']\ndf.head(1)\ndf['age'].mean()\ndf['salary'].describe()","user":"anonymous","dateUpdated":"2019-03-13T03:33:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552446778582_-1982855539","id":"20190313-031258_891896361","dateCreated":"2019-03-13T03:12:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3975","dateFinished":"2019-03-13T03:33:08+0000","dateStarted":"2019-03-13T03:33:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"count        3.000000\nmean     26666.666667\nstd      20816.659995\nmin      10000.000000\n25%      15000.000000\n50%      20000.000000\n75%      35000.000000\nmax      50000.000000\nName: salary, dtype: float64\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\nsqlContext","user":"anonymous","dateUpdated":"2019-03-13T03:38:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552447851200_239799462","id":"20190313-033051_2063645909","dateCreated":"2019-03-13T03:30:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4126","dateFinished":"2019-03-13T03:36:20+0000","dateStarted":"2019-03-13T03:36:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.context.SQLContext object at 0x7f4695f6c4a8>\n"}]}},{"text":"%pyspark\ndata_file = \"file:///tmp/ratings.txt\"\nraw_data  = sc.textFile(data_file)\n#raw_data.take(3)\nheader  = raw_data.first()\nskip_data = raw_data.filter(lambda line: line!=header)\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:40:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448180279_-1437445231","id":"20190313-033620_282697089","dateCreated":"2019-03-13T03:36:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4258","dateFinished":"2019-03-13T03:40:01+0000","dateStarted":"2019-03-13T03:40:01+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['0::0::4', '0::1::5', '0::7495::3']\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import Row\n\ncsv_data = skip_data.map(lambda l: l.split('::') )\ncsv_data.take(3)\n\nrow_data = csv_data.map(lambda p: Row(\n    userid = p[0],\n    itemid = p[1],\n    rating = int(p[2]),\n    ))\nrow_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:44:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448264615_1944574745","id":"20190313-033744_1925834079","dateCreated":"2019-03-13T03:37:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4330","dateFinished":"2019-03-13T03:44:03+0000","dateStarted":"2019-03-13T03:44:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0')]\n"}]}},{"text":"%pyspark\ndf = sqlContext.createDataFrame(row_data)\ndf.select('itemid', 'rating').filter(df.rating > 3).show(3)","user":"anonymous","dateUpdated":"2019-03-13T03:47:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448541300_1003862040","id":"20190313-034221_453618178","dateCreated":"2019-03-13T03:42:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4478","dateFinished":"2019-03-13T03:47:39+0000","dateStarted":"2019-03-13T03:47:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+\n|itemid|rating|\n+------+------+\n|     0|     4|\n|     1|     5|\n|  7496|     5|\n+------+------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\ndf.registerTempTable(\"ratings\")\n","user":"anonymous","dateUpdated":"2019-03-13T03:47:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448678011_445038071","id":"20190313-034438_867600907","dateCreated":"2019-03-13T03:44:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4584","dateFinished":"2019-03-13T03:47:47+0000","dateStarted":"2019-03-13T03:47:46+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:48:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448866920_1872900892","id":"20190313-034746_1273924802","dateCreated":"2019-03-13T03:47:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4858","dateFinished":"2019-03-13T03:48:04+0000","dateStarted":"2019-03-13T03:48:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0')]\n"}]}},{"text":"%pyspark\ndf.show(3)","user":"anonymous","dateUpdated":"2019-03-13T03:48:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448884180_-1274898426","id":"20190313-034804_1466725293","dateCreated":"2019-03-13T03:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4923","dateFinished":"2019-03-13T03:48:11+0000","dateStarted":"2019-03-13T03:48:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n+------+------+------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\ndf.select(\"userid\", \"rating\").groupBy(\"userid\").avg().show()\n","user":"anonymous","dateUpdated":"2019-03-13T03:48:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448891852_55963344","id":"20190313-034811_1964428557","dateCreated":"2019-03-13T03:48:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4995","dateFinished":"2019-03-13T03:48:31+0000","dateStarted":"2019-03-13T03:48:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------------------+\n|userid|       avg(rating)|\n+------+------------------+\n|   296|3.7885714285714287|\n|   467| 3.257575757575758|\n|   675| 3.193661971830986|\n|   691|3.6065573770491803|\n|   829|3.9507042253521125|\n|  1090| 3.398876404494382|\n|  1159|               4.4|\n|  1436| 4.101167315175097|\n|  1512| 3.466666666666667|\n|  1572|             3.895|\n|  2069|3.8285714285714287|\n|  2088|3.7857142857142856|\n|  2136|               3.6|\n|  2162| 2.857142857142857|\n|  2294|               3.0|\n|  2904| 4.222222222222222|\n|  3210| 4.229166666666667|\n|  3414| 4.416666666666667|\n|  3606|               4.0|\n|  3959| 4.538461538461538|\n+------+------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\ndf.printSchema()\n","user":"anonymous","dateUpdated":"2019-03-13T03:50:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552448909127_1902403964","id":"20190313-034829_1404529274","dateCreated":"2019-03-13T03:48:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5070","dateFinished":"2019-03-13T03:50:04+0000","dateStarted":"2019-03-13T03:50:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- itemid: string (nullable = true)\n |-- rating: long (nullable = true)\n |-- userid: string (nullable = true)\n\n"}]}},{"text":"%pyspark\ndf.registerTempTable(\"ratings\")\nratings_data = sqlContext.sql(\"\"\"\n    SELECT userid,avg(rating) from ratings group by userid order by avg(rating) desc \n\"\"\")\nratings_data.show(5)","user":"anonymous","dateUpdated":"2019-03-13T03:51:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552449004093_1147095900","id":"20190313-035004_1874711750","dateCreated":"2019-03-13T03:50:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5151","dateFinished":"2019-03-13T03:51:50+0000","dateStarted":"2019-03-13T03:51:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----------+\n|userid|avg(rating)|\n+------+-----------+\n|  3312|        5.0|\n|  8179|        5.0|\n|  5082|        5.0|\n|  6464|        5.0|\n|  3902|        5.0|\n+------+-----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\nlines = sc.textFile('/tmp/items.txt')\nraw_data = lines.map(lambda e: e.split('::'))\nrow_data2 = raw_data.map(lambda p: Row(itemid=p[0], itemname = p[1]))\ndf2 = sqlContext.createDataFrame(row_data2) \ndf2.registerTempTable(\"items\")","user":"anonymous","dateUpdated":"2019-03-13T03:56:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552449083810_-816987583","id":"20190313-035123_1189082415","dateCreated":"2019-03-13T03:51:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5226","dateFinished":"2019-03-13T03:56:28+0000","dateStarted":"2019-03-13T03:56:28+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ncount_data = sqlContext.sql(\"\"\"\n    SELECT itemname,avg(rating) as avg_rating, count(1) as buy_count from ratings r inner join items i on r.itemid = i.itemid group by itemname order by avg(rating) desc \n\"\"\")\ncount_data.show(5)\n","user":"anonymous","dateUpdated":"2019-03-13T03:58:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552449244331_573757098","id":"20190313-035404_2092237182","dateCreated":"2019-03-13T03:54:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5334","dateFinished":"2019-03-13T03:58:52+0000","dateStarted":"2019-03-13T03:58:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+---------+\n|            itemname|avg_rating|buy_count|\n+--------------------+----------+---------+\n|Archery Adult Ent...|       5.0|        1|\n|Baby Accessories ...|       5.0|        1|\n|Japanese Taiwanes...|       5.0|        1|\n|   Music Venues DJs |       5.0|        1|\n|Jewelry Furniture...|       5.0|        1|\n+--------------------+----------+---------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-03-13T03:57:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552449451448_511699799","id":"20190313-035731_1047238059","dateCreated":"2019-03-13T03:57:31+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5479"}],"name":"Demo20190313","id":"2E6FRD6TE","angularObjects":{"2E5GDVUP7:shared_process":[],"2E5S9J2SF:shared_process":[],"2E8R3B5B8:shared_process":[],"2E8DNB2WY:shared_process":[],"2E8MGRJ58:shared_process":[],"2E68FNPU8:shared_process":[],"2E62CBB7H:shared_process":[],"2E84U37EX:shared_process":[],"2E58ACUCB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
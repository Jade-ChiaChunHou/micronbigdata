{"paragraphs":[{"text":"%pyspark \ndata = [1,2,3,4,5]\nrdd = sc.parallelize(data, 4)\nrdd.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:27:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1552440396492_-1465205978","id":"20190313-012636_2143824384","dateCreated":"2019-03-13T01:26:36+0000","dateStarted":"2019-03-13T01:27:06+0000","dateFinished":"2019-03-13T01:27:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:396"},{"text":"%pyspark\nlines = sc.textFile('file:/tmp/cnn.txt')\nlines\nlines.take(3)\n","user":"anonymous","dateUpdated":"2019-03-13T01:31:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[' (CNN)Hundreds of thousands of people have been evacuated in the central Philippines, where a fierce storm is lashing coastal areas with heavy wind and rain.', '', 'Typhoon Melor has killed at least one person, caused power cuts and disrupted transportation after churning across several islands in the archipelago since Monday.']\n"}]},"apps":[],"jobName":"paragraph_1552440426298_-1078887434","id":"20190313-012706_461298469","dateCreated":"2019-03-13T01:27:06+0000","dateStarted":"2019-03-13T01:31:55+0000","dateFinished":"2019-03-13T01:31:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:397"},{"text":"%python\ndef addnum(a,b):\n    return a + b\n    \naddnum(3,5)\n","user":"anonymous","dateUpdated":"2019-03-13T01:35:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"8\n"}]},"apps":[],"jobName":"paragraph_1552440647396_-359100507","id":"20190313-013047_2056815560","dateCreated":"2019-03-13T01:30:47+0000","dateStarted":"2019-03-13T01:35:32+0000","dateFinished":"2019-03-13T01:35:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:398"},{"text":"%python\nf = lambda a,b: a + b\nf(5,6)","user":"anonymous","dateUpdated":"2019-03-13T01:36:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"11\n"}]},"apps":[],"jobName":"paragraph_1552440932848_1115083255","id":"20190313-013532_352308924","dateCreated":"2019-03-13T01:35:32+0000","dateStarted":"2019-03-13T01:36:29+0000","dateFinished":"2019-03-13T01:36:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%pyspark\nrdd = sc.parallelize([1, 2, 3, 4])\nrdd2 = rdd.map(lambda x: x * 2)\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-03-13T01:40:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 8]\n"}]},"apps":[],"jobName":"paragraph_1552440984807_848360322","id":"20190313-013624_1841736493","dateCreated":"2019-03-13T01:36:24+0000","dateStarted":"2019-03-13T01:40:11+0000","dateFinished":"2019-03-13T01:40:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%pyspark\nrdd2 = rdd.filter(lambda x: x%2 == 0)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:40:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4]\n"}]},"apps":[],"jobName":"paragraph_1552441146919_1015188103","id":"20190313-013906_328500943","dateCreated":"2019-03-13T01:39:06+0000","dateStarted":"2019-03-13T01:40:40+0000","dateFinished":"2019-03-13T01:40:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%pyspark\nrdd = sc.parallelize([1,4,2,2,3])\nrdd2 = rdd.distinct()\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:41:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4]\n"}]},"apps":[],"jobName":"paragraph_1552441240248_-1356298492","id":"20190313-014040_269402105","dateCreated":"2019-03-13T01:40:40+0000","dateStarted":"2019-03-13T01:41:28+0000","dateFinished":"2019-03-13T01:41:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%pyspark\nrdd =  sc.parallelize([1,2,3])\nrdd2 = rdd.map(lambda x: [x, x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:42:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 6], [2, 7], [3, 8]]\n"}]},"apps":[],"jobName":"paragraph_1552441276379_-598297186","id":"20190313-014116_1117739274","dateCreated":"2019-03-13T01:41:16+0000","dateStarted":"2019-03-13T01:42:32+0000","dateFinished":"2019-03-13T01:42:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%pyspark\nrdd2 = rdd.flatMap(lambda x: [x, x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-03-13T01:42:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 6, 2, 7, 3, 8]\n"}]},"apps":[],"jobName":"paragraph_1552441352367_-1055624067","id":"20190313-014232_2062643427","dateCreated":"2019-03-13T01:42:32+0000","dateStarted":"2019-03-13T01:42:57+0000","dateFinished":"2019-03-13T01:42:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.reduce(lambda a,b:a*b)\n","user":"anonymous","dateUpdated":"2019-03-13T02:07:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"6\n"}]},"apps":[],"jobName":"paragraph_1552441377788_-2038626858","id":"20190313-014257_268211193","dateCreated":"2019-03-13T01:42:57+0000","dateStarted":"2019-03-13T02:07:53+0000","dateFinished":"2019-03-13T02:07:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"%pyspark\nrdd.take(2)","user":"anonymous","dateUpdated":"2019-03-13T02:08:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2]\n"}]},"apps":[],"jobName":"paragraph_1552442867041_-1787684684","id":"20190313-020747_1573901740","dateCreated":"2019-03-13T02:07:47+0000","dateStarted":"2019-03-13T02:08:09+0000","dateFinished":"2019-03-13T02:08:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-03-13T02:08:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1552442889277_781329694","id":"20190313-020809_210288788","dateCreated":"2019-03-13T02:08:09+0000","dateStarted":"2019-03-13T02:08:18+0000","dateFinished":"2019-03-13T02:08:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"%pyspark\nrdd=sc.parallelize([5,3,1,2])\nrdd.takeOrdered(3,lambda s:-1*s)\n","user":"anonymous","dateUpdated":"2019-03-13T02:08:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 3, 2]\n"}]},"apps":[],"jobName":"paragraph_1552442898152_1747834255","id":"20190313-020818_2133166708","dateCreated":"2019-03-13T02:08:18+0000","dateStarted":"2019-03-13T02:08:55+0000","dateFinished":"2019-03-13T02:08:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"%pyspark\nrdd = sc.parallelize([(1,2),(3,4),(3,6)])\nrdd2 = rdd.reduceByKey(lambda a, b: a + b)  \nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-03-13T02:15:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 10)]\n"}]},"apps":[],"jobName":"paragraph_1552442935738_1991642465","id":"20190313-020855_1942651080","dateCreated":"2019-03-13T02:08:55+0000","dateStarted":"2019-03-13T02:15:31+0000","dateFinished":"2019-03-13T02:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:409"},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd3 = rdd2.sortByKey()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-03-13T02:16:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"}]},"apps":[],"jobName":"paragraph_1552443320720_1540263606","id":"20190313-021520_1334525823","dateCreated":"2019-03-13T02:15:20+0000","dateStarted":"2019-03-13T02:16:15+0000","dateFinished":"2019-03-13T02:16:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:410"},{"text":"%pyspark\nbroadcastVar = sc.broadcast([1, 2, 3]) \nbroadcastVar.value","user":"anonymous","dateUpdated":"2019-03-13T02:22:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1552443375236_687721340","id":"20190313-021615_892971271","dateCreated":"2019-03-13T02:16:15+0000","dateStarted":"2019-03-13T02:22:08+0000","dateFinished":"2019-03-13T02:22:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"%pyspark\naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n    global accum\n    accum += x  \n \nrdd.foreach(f) \naccum.value\n","user":"anonymous","dateUpdated":"2019-03-13T02:24:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1552443728187_-210914173","id":"20190313-022208_621320289","dateCreated":"2019-03-13T02:22:08+0000","dateStarted":"2019-03-13T02:24:54+0000","dateFinished":"2019-03-13T02:24:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"%pyspark\nlines = sc.textFile('file:/tmp/cnn.txt')\nrdd  =   lines.flatMap(lambda line: line.split()).map(lambda e: (e, 1)).reduceByKey(lambda a,b: a+b).sortBy(lambda a: -a[1])\nrdd.take(5)","user":"anonymous","dateUpdated":"2019-03-13T02:34:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('the', 18), ('of', 10), ('in', 9), ('to', 6), ('a', 5)]\n"}]},"apps":[],"jobName":"paragraph_1552443894658_-249191493","id":"20190313-022454_1678869261","dateCreated":"2019-03-13T02:24:54+0000","dateStarted":"2019-03-13T02:34:50+0000","dateFinished":"2019-03-13T02:34:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"%pyspark \nlines = sc.textFile('file:///tmp/u.data')\nlines.take(3)\nmovies = lines.map(lambda e : (e.split()[1], 1) )\nmovieCounts = movies.reduceByKey(lambda x,y: x+y)\nmovieCounts.take(3)\nres = movieCounts.sortBy(lambda a: -a[1])\nres.take(3)\n","user":"anonymous","dateUpdated":"2019-03-13T02:43:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('50', 583), ('258', 509), ('100', 508)]\n"}]},"apps":[],"jobName":"paragraph_1552444214258_818550170","id":"20190313-023014_250150485","dateCreated":"2019-03-13T02:30:14+0000","dateStarted":"2019-03-13T02:43:36+0000","dateFinished":"2019-03-13T02:43:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"text":"%python\ns = '196\\t242\\t3\\t881250949'\ns.split()","user":"anonymous","dateUpdated":"2019-03-13T02:41:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'242'\n"}]},"apps":[],"jobName":"paragraph_1552444746238_-1996706794","id":"20190313-023906_512550432","dateCreated":"2019-03-13T02:39:06+0000","dateStarted":"2019-03-13T02:41:47+0000","dateFinished":"2019-03-13T02:41:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:415"},{"text":"%python\ndic = {}\nwith open('/tmp/u.item', encoding = 'latin1') as f:\n    for line in f:\n        ele =line.split('|')\n        dic[ele[0]] = ele[1]\n#dic\n","user":"anonymous","dateUpdated":"2019-03-13T03:11:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552444896087_-1229134383","id":"20190313-024136_527288480","dateCreated":"2019-03-13T02:41:36+0000","dateStarted":"2019-03-13T03:11:50+0000","dateFinished":"2019-03-13T03:11:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:416"},{"text":"%pyspark\n\ndef loadMovieNames():\n    movieNames = {}\n    with open('/tmp/u.item', encoding = 'latin1') as f:\n        for line in f:\n            ele =line.split('|')\n            movieNames[ele[0]] = ele[1]\n    return movieNames\nnamedict= sc.broadcast(loadMovieNames())\n","user":"anonymous","dateUpdated":"2019-03-13T03:11:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552446223341_-1343784327","id":"20190313-030343_370283773","dateCreated":"2019-03-13T03:03:43+0000","dateStarted":"2019-03-13T03:11:17+0000","dateFinished":"2019-03-13T03:11:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"%pyspark\nlines = sc.textFile('file:///tmp/u.data')\nmovies = lines.map(lambda e : (e.split()[1], 1) )\nmovieCounts = movies.reduceByKey(lambda x,y: x+y)\nres = movieCounts.sortBy(lambda a: -a[1])\nres2 = res.map(lambda e: (namedict.value.get(e[0]), e[1]) )\nres2.take(10)","user":"anonymous","dateUpdated":"2019-03-13T03:13:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Star Wars (1977)', 583), ('Contact (1997)', 509), ('Fargo (1996)', 508), ('Return of the Jedi (1983)', 507), ('Liar Liar (1997)', 485), ('English Patient, The (1996)', 481), ('Scream (1996)', 478), ('Toy Story (1995)', 452), ('Air Force One (1997)', 431), ('Independence Day (ID4) (1996)', 429)]\n"}]},"apps":[],"jobName":"paragraph_1552446666351_823148838","id":"20190313-031106_1128030066","dateCreated":"2019-03-13T03:11:06+0000","dateStarted":"2019-03-13T03:13:24+0000","dateFinished":"2019-03-13T03:13:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%python \nimport pandas\ndf = pandas.DataFrame([['Mary',23, 10000], ['John',32, 20000], ['Joe',35, 50000]])\ndf.columns = ['name', 'age', 'salary']\ndf.head(1)\ndf['age'].mean()\ndf['salary'].describe()","user":"anonymous","dateUpdated":"2019-03-13T03:33:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"count        3.000000\nmean     26666.666667\nstd      20816.659995\nmin      10000.000000\n25%      15000.000000\n50%      20000.000000\n75%      35000.000000\nmax      50000.000000\nName: salary, dtype: float64\n"}]},"apps":[],"jobName":"paragraph_1552446778582_-1982855539","id":"20190313-031258_891896361","dateCreated":"2019-03-13T03:12:58+0000","dateStarted":"2019-03-13T03:33:08+0000","dateFinished":"2019-03-13T03:33:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\nsqlContext","user":"anonymous","dateUpdated":"2019-03-13T03:38:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.context.SQLContext object at 0x7f4695f6c4a8>\n"}]},"apps":[],"jobName":"paragraph_1552447851200_239799462","id":"20190313-033051_2063645909","dateCreated":"2019-03-13T03:30:51+0000","dateStarted":"2019-03-13T03:36:20+0000","dateFinished":"2019-03-13T03:36:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:420"},{"text":"%pyspark\ndata_file = \"file:///tmp/ratings.txt\"\nraw_data  = sc.textFile(data_file)\n#raw_data.take(3)\nheader  = raw_data.first()\nskip_data = raw_data.filter(lambda line: line!=header)\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:40:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['0::0::4', '0::1::5', '0::7495::3']\n"}]},"apps":[],"jobName":"paragraph_1552448180279_-1437445231","id":"20190313-033620_282697089","dateCreated":"2019-03-13T03:36:20+0000","dateStarted":"2019-03-13T03:40:01+0000","dateFinished":"2019-03-13T03:40:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"%pyspark\nfrom pyspark.sql import Row\n\ncsv_data = skip_data.map(lambda l: l.split('::') )\ncsv_data.take(3)\n\nrow_data = csv_data.map(lambda p: Row(\n    userid = p[0],\n    itemid = p[1],\n    rating = int(p[2]),\n    ))\nrow_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:44:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0')]\n"}]},"apps":[],"jobName":"paragraph_1552448264615_1944574745","id":"20190313-033744_1925834079","dateCreated":"2019-03-13T03:37:44+0000","dateStarted":"2019-03-13T03:44:03+0000","dateFinished":"2019-03-13T03:44:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"%pyspark\ndf = sqlContext.createDataFrame(row_data)\ndf.select('itemid', 'rating').filter(df.rating > 3).show(3)","user":"anonymous","dateUpdated":"2019-03-13T03:47:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+\n|itemid|rating|\n+------+------+\n|     0|     4|\n|     1|     5|\n|  7496|     5|\n+------+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552448541300_1003862040","id":"20190313-034221_453618178","dateCreated":"2019-03-13T03:42:21+0000","dateStarted":"2019-03-13T03:47:39+0000","dateFinished":"2019-03-13T03:47:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"%pyspark\ndf.registerTempTable(\"ratings\")\n","user":"anonymous","dateUpdated":"2019-03-13T03:47:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552448678011_445038071","id":"20190313-034438_867600907","dateCreated":"2019-03-13T03:44:38+0000","dateStarted":"2019-03-13T03:47:46+0000","dateFinished":"2019-03-13T03:47:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"%pyspark\ndf.take(3)","user":"anonymous","dateUpdated":"2019-03-13T03:48:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0')]\n"}]},"apps":[],"jobName":"paragraph_1552448866920_1872900892","id":"20190313-034746_1273924802","dateCreated":"2019-03-13T03:47:46+0000","dateStarted":"2019-03-13T03:48:04+0000","dateFinished":"2019-03-13T03:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%pyspark\ndf.show(3)","user":"anonymous","dateUpdated":"2019-03-13T03:48:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n+------+------+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552448884180_-1274898426","id":"20190313-034804_1466725293","dateCreated":"2019-03-13T03:48:04+0000","dateStarted":"2019-03-13T03:48:11+0000","dateFinished":"2019-03-13T03:48:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:426"},{"text":"%pyspark\ndf.select(\"userid\", \"rating\").groupBy(\"userid\").avg().show()\n","user":"anonymous","dateUpdated":"2019-03-13T03:48:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------------------+\n|userid|       avg(rating)|\n+------+------------------+\n|   296|3.7885714285714287|\n|   467| 3.257575757575758|\n|   675| 3.193661971830986|\n|   691|3.6065573770491803|\n|   829|3.9507042253521125|\n|  1090| 3.398876404494382|\n|  1159|               4.4|\n|  1436| 4.101167315175097|\n|  1512| 3.466666666666667|\n|  1572|             3.895|\n|  2069|3.8285714285714287|\n|  2088|3.7857142857142856|\n|  2136|               3.6|\n|  2162| 2.857142857142857|\n|  2294|               3.0|\n|  2904| 4.222222222222222|\n|  3210| 4.229166666666667|\n|  3414| 4.416666666666667|\n|  3606|               4.0|\n|  3959| 4.538461538461538|\n+------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552448891852_55963344","id":"20190313-034811_1964428557","dateCreated":"2019-03-13T03:48:11+0000","dateStarted":"2019-03-13T03:48:29+0000","dateFinished":"2019-03-13T03:48:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:427"},{"text":"%pyspark\ndf.printSchema()\n","user":"anonymous","dateUpdated":"2019-03-13T03:50:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- itemid: string (nullable = true)\n |-- rating: long (nullable = true)\n |-- userid: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1552448909127_1902403964","id":"20190313-034829_1404529274","dateCreated":"2019-03-13T03:48:29+0000","dateStarted":"2019-03-13T03:50:04+0000","dateFinished":"2019-03-13T03:50:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:428"},{"text":"%pyspark\ndf.registerTempTable(\"ratings\")\nratings_data = sqlContext.sql(\"\"\"\n    SELECT userid,avg(rating) from ratings group by userid order by avg(rating) desc \n\"\"\")\nratings_data.show(5)","user":"anonymous","dateUpdated":"2019-03-13T03:51:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----------+\n|userid|avg(rating)|\n+------+-----------+\n|  3312|        5.0|\n|  8179|        5.0|\n|  5082|        5.0|\n|  6464|        5.0|\n|  3902|        5.0|\n+------+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552449004093_1147095900","id":"20190313-035004_1874711750","dateCreated":"2019-03-13T03:50:04+0000","dateStarted":"2019-03-13T03:51:48+0000","dateFinished":"2019-03-13T03:51:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:429"},{"text":"%pyspark\nlines = sc.textFile('/tmp/items.txt')\nraw_data = lines.map(lambda e: e.split('::'))\nrow_data2 = raw_data.map(lambda p: Row(itemid=p[0], itemname = p[1]))\ndf2 = sqlContext.createDataFrame(row_data2) \ndf2.registerTempTable(\"items\")","user":"anonymous","dateUpdated":"2019-03-13T03:56:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552449083810_-816987583","id":"20190313-035123_1189082415","dateCreated":"2019-03-13T03:51:23+0000","dateStarted":"2019-03-13T03:56:28+0000","dateFinished":"2019-03-13T03:56:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:430"},{"text":"%pyspark\ncount_data = sqlContext.sql(\"\"\"\n    SELECT itemname,avg(rating) as avg_rating, count(1) as buy_count from ratings r inner join items i on r.itemid = i.itemid group by itemname order by avg(rating) desc \n\"\"\")\ncount_data.show(5)\n","user":"anonymous","dateUpdated":"2019-03-13T03:58:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+---------+\n|            itemname|avg_rating|buy_count|\n+--------------------+----------+---------+\n|Archery Adult Ent...|       5.0|        1|\n|Baby Accessories ...|       5.0|        1|\n|Japanese Taiwanes...|       5.0|        1|\n|   Music Venues DJs |       5.0|        1|\n|Jewelry Furniture...|       5.0|        1|\n+--------------------+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552449244331_573757098","id":"20190313-035404_2092237182","dateCreated":"2019-03-13T03:54:04+0000","dateStarted":"2019-03-13T03:58:46+0000","dateFinished":"2019-03-13T03:58:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:431"},{"text":"%pyspark\nratings = sc.textFile('file:///tmp/u.data', 4)\nratings.take(3)\nratings_data = ratings.map(lambda e: e.split())\nratings_data.take(3)\nratings_row_data  = ratings_data.map(lambda p: \n    Row(userid=p[0],movieid = p[1], rating=int(p[2])))\ndf = sqlContext.createDataFrame(ratings_row_data)\ndf.show(3)\ndf.registerTempTable('ratings')","user":"anonymous","dateUpdated":"2019-03-13T05:22:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552449451448_511699799","id":"20190313-035731_1047238059","dateCreated":"2019-03-13T03:57:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:432","dateFinished":"2019-03-13T05:22:15+0000","dateStarted":"2019-03-13T05:22:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+------+\n|movieid|rating|userid|\n+-------+------+------+\n|    242|     3|   196|\n|    302|     3|   186|\n|    377|     1|    22|\n+-------+------+------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\nmovies = sc.textFile('file:///tmp/u.item', 4)\nmovies.take(3)\n\nmovies_data = movies.map(lambda l:l.split('|'))\nmovies_data.take(3)\nmovies_row_data = movies_data.map(lambda p: Row(movieid = p[0], moviename = p[1]))\nmovies_row_data.take(3)\nmovies_df = sqlContext.createDataFrame(movies_row_data)\nmovies_df.registerTempTable(\"movies\")","user":"anonymous","dateUpdated":"2019-03-13T05:26:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552454384441_-784118126","id":"20190313-051944_1059630443","dateCreated":"2019-03-13T05:19:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2988","dateFinished":"2019-03-13T05:26:28+0000","dateStarted":"2019-03-13T05:26:28+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nbest_movies = sqlContext.sql(\"\"\"\n     SELECT moviename,avg(rating) as avg_rating, count(1) as cnt  from movies inner join ratings on ratings.movieid = movies.movieid group by moviename order by  avg(rating) desc limit 10\n\"\"\")\nbest_movies.show(5)","user":"anonymous","dateUpdated":"2019-03-13T05:27:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552454576440_1188752164","id":"20190313-052256_1338582277","dateCreated":"2019-03-13T05:22:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3169","dateFinished":"2019-03-13T05:27:12+0000","dateStarted":"2019-03-13T05:27:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+---+\n|           moviename|avg_rating|cnt|\n+--------------------+----------+---+\n|Someone Else's Am...|       5.0|  1|\n|Saint of Fort Was...|       5.0|  2|\n|     Star Kid (1997)|       5.0|  3|\n|Aiqing wansui (1994)|       5.0|  1|\n|Marlene Dietrich:...|       5.0|  1|\n+--------------------+----------+---+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspaark","user":"anonymous","dateUpdated":"2019-03-13T06:09:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552454830643_1973222879","id":"20190313-052710_1961646465","dateCreated":"2019-03-13T05:27:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3330","dateFinished":"2019-03-13T06:09:12+0000","dateStarted":"2019-03-13T06:09:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-03-13 06:09:11--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/churnTrain.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 356734 (348K) [text/plain]\nSaving to: ‘churnTrain.csv’\n\n     0K .......... .......... .......... .......... .......... 14% 1.99M 0s\n    50K .......... .......... .......... .......... .......... 28% 3.97M 0s\n   100K .......... .......... .......... .......... .......... 43%  139M 0s\n   150K .......... .......... .......... .......... .......... 57%  141M 0s\n   200K .......... .......... .......... .......... .......... 71% 4.01M 0s\n   250K .......... .......... .......... .......... .......... 86%  155M 0s\n   300K .......... .......... .......... .......... ........  100%  145M=0.05s\n\n2019-03-13 06:09:12 (6.75 MB/s) - ‘churnTrain.csv’ saved [356734/356734]\n\n"}]}},{"text":"%md\n##  Spark 與機器學習","user":"anonymous","dateUpdated":"2019-03-13T06:10:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457351734_2038479118","id":"20190313-060911_1762702480","dateCreated":"2019-03-13T06:09:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3416","dateFinished":"2019-03-13T06:10:16+0000","dateStarted":"2019-03-13T06:10:16+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Spark 與機器學習</h2>\n</div>"}]}},{"text":"%pyspark\n\nraw_data = sc.textFile('file:///tmp/churnTrain.csv')\nraw_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T06:11:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457403695_21453529","id":"20190313-061003_236766075","dateCreated":"2019-03-13T06:10:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3539","dateFinished":"2019-03-13T06:11:20+0000","dateStarted":"2019-03-13T06:11:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['\"\",\"state\",\"account_length\",\"area_code\",\"international_plan\",\"voice_mail_plan\",\"number_vmail_messages\",\"total_day_minutes\",\"total_day_calls\",\"total_day_charge\",\"total_eve_minutes\",\"total_eve_calls\",\"total_eve_charge\",\"total_night_minutes\",\"total_night_calls\",\"total_night_charge\",\"total_intl_minutes\",\"total_intl_calls\",\"total_intl_charge\",\"number_customer_service_calls\",\"churn\"', '\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"', '\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"']\n"}]}},{"text":"%pyspark\nheader = raw_data.first()\nskip_data = raw_data.filter(lambda line:line!=header)\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-03-13T06:12:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457469215_-514978383","id":"20190313-061109_1729916581","dateCreated":"2019-03-13T06:11:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3641","dateFinished":"2019-03-13T06:12:15+0000","dateStarted":"2019-03-13T06:12:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"', '\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"', '\"3\",\"NJ\",137,\"area_code_415\",\"no\",\"no\",0,243.4,114,41.38,121.2,110,10.3,162.6,104,7.32,12.2,5,3.29,0,\"no\"']\n"}]}},{"text":"%pyspark\nsplitlines= skip_data.map(lambda l:l.split(','))\nsplitlines.take(3)","user":"anonymous","dateUpdated":"2019-03-13T06:13:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457535495_10496670","id":"20190313-061215_1658790996","dateCreated":"2019-03-13T06:12:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3722","dateFinished":"2019-03-13T06:13:10+0000","dateStarted":"2019-03-13T06:13:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['\"1\"', '\"KS\"', '128', '\"area_code_415\"', '\"no\"', '\"yes\"', '25', '265.1', '110', '45.07', '197.4', '99', '16.78', '244.7', '91', '11.01', '10', '3', '2.7', '1', '\"no\"'], ['\"2\"', '\"OH\"', '107', '\"area_code_415\"', '\"no\"', '\"yes\"', '26', '161.6', '123', '27.47', '195.5', '103', '16.62', '254.4', '103', '11.45', '13.7', '3', '3.7', '1', '\"no\"'], ['\"3\"', '\"NJ\"', '137', '\"area_code_415\"', '\"no\"', '\"no\"', '0', '243.4', '114', '41.38', '121.2', '110', '10.3', '162.6', '104', '7.32', '12.2', '5', '3.29', '0', '\"no\"']]\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.mllib.linalg import Vectors\ndef parseLine(col):\n    features = []\n    churn = col[-1]\n    international = 0 if col[4] == '\"no\"' else 1\n    voice = 0 if col[5] == '\"no\"'  else 1\n    label = 0 if churn == '\"no\"' else 1\n    features.append(international)\n    features.append(voice)\n    features += col[6:-1]\n    return LabeledPoint(label, Vectors.dense(features))\n\ntrainData = splitlines.map(parseLine)\ntrainData.take(3)","user":"anonymous","dateUpdated":"2019-03-13T06:19:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457569537_-6771058","id":"20190313-061249_380828191","dateCreated":"2019-03-13T06:12:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3794","dateFinished":"2019-03-13T06:19:22+0000","dateStarted":"2019-03-13T06:19:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[LabeledPoint(0.0, [0.0,1.0,25.0,265.1,110.0,45.07,197.4,99.0,16.78,244.7,91.0,11.01,10.0,3.0,2.7,1.0]), LabeledPoint(0.0, [0.0,1.0,26.0,161.6,123.0,27.47,195.5,103.0,16.62,254.4,103.0,11.45,13.7,3.0,3.7,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,243.4,114.0,41.38,121.2,110.0,10.3,162.6,104.0,7.32,12.2,5.0,3.29,0.0])]\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.tree import DecisionTree\n\nmodel = DecisionTree.trainClassifier(trainData, numClasses=2, categoricalFeaturesInfo={},\n                                     impurity='gini', maxDepth=5)\n","user":"anonymous","dateUpdated":"2019-03-13T06:21:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552457938956_-1679758323","id":"20190313-061858_471619759","dateCreated":"2019-03-13T06:18:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3890","dateFinished":"2019-03-13T06:21:14+0000","dateStarted":"2019-03-13T06:21:11+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nprint(model.toDebugString())\n","user":"anonymous","dateUpdated":"2019-03-13T06:22:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458071800_934441888","id":"20190313-062111_721058651","dateCreated":"2019-03-13T06:21:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4000","dateFinished":"2019-03-13T06:22:28+0000","dateStarted":"2019-03-13T06:22:27+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DecisionTreeModel classifier of depth 5 with 57 nodes\n  If (feature 3 <= 264.7)\n   If (feature 15 <= 3.0)\n    If (feature 0 <= 0.0)\n     If (feature 3 <= 221.4)\n      If (feature 4 <= 120.0)\n       Predict: 0.0\n      Else (feature 4 > 120.0)\n       Predict: 0.0\n     Else (feature 3 > 221.4)\n      If (feature 6 <= 259.8)\n       Predict: 0.0\n      Else (feature 6 > 259.8)\n       Predict: 1.0\n    Else (feature 0 > 0.0)\n     If (feature 13 <= 2.0)\n      Predict: 1.0\n     Else (feature 13 > 2.0)\n      If (feature 12 <= 12.9)\n       Predict: 0.0\n      Else (feature 12 > 12.9)\n       Predict: 1.0\n   Else (feature 15 > 3.0)\n    If (feature 3 <= 161.3)\n     If (feature 6 <= 230.2)\n      If (feature 9 <= 252.7)\n       Predict: 1.0\n      Else (feature 9 > 252.7)\n       Predict: 1.0\n     Else (feature 6 > 230.2)\n      If (feature 3 <= 138.5)\n       Predict: 1.0\n      Else (feature 3 > 138.5)\n       Predict: 0.0\n    Else (feature 3 > 161.3)\n     If (feature 6 <= 156.0)\n      If (feature 3 <= 193.3)\n       Predict: 1.0\n      Else (feature 3 > 193.3)\n       Predict: 0.0\n     Else (feature 6 > 156.0)\n      If (feature 3 <= 179.4)\n       Predict: 0.0\n      Else (feature 3 > 179.4)\n       Predict: 0.0\n  Else (feature 3 > 264.7)\n   If (feature 1 <= 0.0)\n    If (feature 6 <= 184.9)\n     If (feature 9 <= 213.3)\n      If (feature 3 <= 280.4)\n       Predict: 0.0\n      Else (feature 3 > 280.4)\n       Predict: 0.0\n     Else (feature 9 > 213.3)\n      If (feature 6 <= 123.5)\n       Predict: 0.0\n      Else (feature 6 > 123.5)\n       Predict: 1.0\n    Else (feature 6 > 184.9)\n     If (feature 9 <= 123.2)\n      If (feature 10 <= 103.0)\n       Predict: 1.0\n      Else (feature 10 > 103.0)\n       Predict: 0.0\n     Else (feature 9 > 123.2)\n      If (feature 6 <= 201.3)\n       Predict: 1.0\n      Else (feature 6 > 201.3)\n       Predict: 1.0\n   Else (feature 1 > 0.0)\n    If (feature 0 <= 0.0)\n     If (feature 6 <= 259.8)\n      Predict: 0.0\n     Else (feature 6 > 259.8)\n      If (feature 7 <= 103.0)\n       Predict: 0.0\n      Else (feature 7 > 103.0)\n       Predict: 1.0\n    Else (feature 0 > 0.0)\n     If (feature 3 <= 280.4)\n      Predict: 1.0\n     Else (feature 3 > 280.4)\n      If (feature 9 <= 229.8)\n       Predict: 0.0\n      Else (feature 9 > 229.8)\n       Predict: 1.0\n\n"}]}},{"text":"%pyspark\nhead = trainData.first()\nprint(model.predict(head.features))\n\n","user":"anonymous","dateUpdated":"2019-03-13T06:22:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458125780_-848207036","id":"20190313-062205_42819580","dateCreated":"2019-03-13T06:22:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4072","dateFinished":"2019-03-13T06:22:56+0000","dateStarted":"2019-03-13T06:22:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.0\n"}]}},{"text":"%pyspark\npredictions = model.predict(trainData.map(lambda p: p.features))\npredictions.take(3)","user":"anonymous","dateUpdated":"2019-03-13T06:24:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458168456_1278746181","id":"20190313-062248_546149426","dateCreated":"2019-03-13T06:22:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4178","dateFinished":"2019-03-13T06:24:10+0000","dateStarted":"2019-03-13T06:24:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0.0, 0.0, 0.0]\n"}]}},{"text":"%pyspark\nlabels_and_preds = trainData.map(lambda p: p.label).zip(predictions)\n","user":"anonymous","dateUpdated":"2019-03-13T06:25:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458250416_-1143758777","id":"20190313-062410_387391282","dateCreated":"2019-03-13T06:24:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4277","dateFinished":"2019-03-13T06:25:23+0000","dateStarted":"2019-03-13T06:25:23+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nlabels_and_preds = trainData.map(lambda p: p.label).zip(predictions)\n#labels_and_preds.take(100)\nfiltered_labels_and_preds = labels_and_preds.filter(lambda v : v[0] == v[1]) \ntest_accuracy = filtered_labels_and_preds.count() / float(trainData.count())\ntest_accuracy","user":"anonymous","dateUpdated":"2019-03-13T06:26:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458261115_1690163704","id":"20190313-062421_575644368","dateCreated":"2019-03-13T06:24:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4361","dateFinished":"2019-03-13T06:26:50+0000","dateStarted":"2019-03-13T06:26:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.9492949294929492\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-03-13T06:24:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552458270616_-1671387436","id":"20190313-062430_1632152188","dateCreated":"2019-03-13T06:24:30+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4420"}],"name":"Demo20190313","id":"2E6FRD6TE","angularObjects":{"2E5GDVUP7:shared_process":[],"2E5S9J2SF:shared_process":[],"2E8R3B5B8:shared_process":[],"2E8DNB2WY:shared_process":[],"2E8MGRJ58:shared_process":[],"2E68FNPU8:shared_process":[],"2E62CBB7H:shared_process":[],"2E84U37EX:shared_process":[],"2E58ACUCB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
{"paragraphs":[{"text":"%pyspark\ndata = [1,2,3,4,5]\nrdd  = sc.parallelize(data, 4)\nrdd.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:30:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1550539591179_-844262416","id":"20190219-012631_1044432015","dateCreated":"2019-02-19T01:26:31+0000","dateStarted":"2019-02-19T01:30:48+0000","dateFinished":"2019-02-19T01:30:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1157"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/cnn.txt\nmv cnn.txt /tmp/cnn.txt","user":"anonymous","dateUpdated":"2019-02-19T01:34:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-02-19 01:34:11--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/cnn.txt\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1999 (2.0K) [text/plain]\nSaving to: ‘cnn.txt.1’\n\n     0K .                                                     100% 15.4M=0s\n\n2019-02-19 01:34:12 (15.4 MB/s) - ‘cnn.txt.1’ saved [1999/1999]\n\n"}]},"apps":[],"jobName":"paragraph_1550539731099_623386072","id":"20190219-012851_1864681960","dateCreated":"2019-02-19T01:28:51+0000","dateStarted":"2019-02-19T01:34:11+0000","dateFinished":"2019-02-19T01:34:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1158"},{"text":"%pyspark\nlines = sc.textFile('file:/tmp/cnn.txt')\nlines.take(3)","user":"anonymous","dateUpdated":"2019-02-19T01:35:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[' (CNN)Hundreds of thousands of people have been evacuated in the central Philippines, where a fierce storm is lashing coastal areas with heavy wind and rain.', '', 'Typhoon Melor has killed at least one person, caused power cuts and disrupted transportation after churning across several islands in the archipelago since Monday.']\n"}]},"apps":[],"jobName":"paragraph_1550539967458_-935491710","id":"20190219-013247_2075586649","dateCreated":"2019-02-19T01:32:47+0000","dateStarted":"2019-02-19T01:35:46+0000","dateFinished":"2019-02-19T01:35:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1159"},{"text":"%python\ndef func(e):\n    a = e ** 2\n    return a\nfunc(3)\n   \nsquare2 = lambda e: e** 2\nsquare2(4)\n","user":"anonymous","dateUpdated":"2019-02-19T01:42:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"16\n"}]},"apps":[],"jobName":"paragraph_1550540106918_-1030357767","id":"20190219-013506_1540423874","dateCreated":"2019-02-19T01:35:06+0000","dateStarted":"2019-02-19T01:42:07+0000","dateFinished":"2019-02-19T01:42:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1160"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3,4])\nrdd2 = rdd.map(lambda x: x * 2)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:48:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 8]\n"}]},"apps":[],"jobName":"paragraph_1550540490478_-2076321460","id":"20190219-014130_801556916","dateCreated":"2019-02-19T01:41:30+0000","dateStarted":"2019-02-19T01:48:08+0000","dateFinished":"2019-02-19T01:48:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1161"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3,4])\nrdd2 = rdd.filter(lambda x: x % 2 == 0 )\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:51:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4]\n"}]},"apps":[],"jobName":"paragraph_1550540838549_-799433451","id":"20190219-014718_504043284","dateCreated":"2019-02-19T01:47:18+0000","dateStarted":"2019-02-19T01:51:59+0000","dateFinished":"2019-02-19T01:51:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1162"},{"text":"%pyspark\nrdd=sc.parallelize([1,4,2,2,3])\nrdd2 = rdd.distinct()\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:52:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4]\n"}]},"apps":[],"jobName":"paragraph_1550541119182_-410256911","id":"20190219-015159_593038513","dateCreated":"2019-02-19T01:51:59+0000","dateStarted":"2019-02-19T01:52:43+0000","dateFinished":"2019-02-19T01:52:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1163"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd2 = rdd.map(lambda x: [x,x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:54:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 6], [2, 7], [3, 8]]\n"}]},"apps":[],"jobName":"paragraph_1550541159178_514122841","id":"20190219-015239_1497722168","dateCreated":"2019-02-19T01:52:39+0000","dateStarted":"2019-02-19T01:54:02+0000","dateFinished":"2019-02-19T01:54:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1164"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd2 = rdd.flatMap(lambda x: [x,x+5])\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:54:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 6, 2, 7, 3, 8]\n"}]},"apps":[],"jobName":"paragraph_1550541242919_914985222","id":"20190219-015402_1044842207","dateCreated":"2019-02-19T01:54:02+0000","dateStarted":"2019-02-19T01:54:25+0000","dateFinished":"2019-02-19T01:54:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1165"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.reduce(lambda a,b:a*b)\n","user":"anonymous","dateUpdated":"2019-02-19T01:56:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"6\n"}]},"apps":[],"jobName":"paragraph_1550541260908_-1246702664","id":"20190219-015420_329180254","dateCreated":"2019-02-19T01:54:20+0000","dateStarted":"2019-02-19T01:56:05+0000","dateFinished":"2019-02-19T01:56:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1166"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.take(2)","user":"anonymous","dateUpdated":"2019-02-19T01:57:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2]\n"}]},"apps":[],"jobName":"paragraph_1550541365188_-376061876","id":"20190219-015605_907178580","dateCreated":"2019-02-19T01:56:05+0000","dateStarted":"2019-02-19T01:57:16+0000","dateFinished":"2019-02-19T01:57:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1167"},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-02-19T01:57:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1550541436219_-266534322","id":"20190219-015716_614411101","dateCreated":"2019-02-19T01:57:16+0000","dateStarted":"2019-02-19T01:57:26+0000","dateFinished":"2019-02-19T01:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1168"},{"text":"%pyspark\nrdd = sc.parallelize([5,3,1,2])\nrdd.takeOrdered(3,lambda s:-1*s)\n","user":"anonymous","dateUpdated":"2019-02-19T01:58:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 3, 2]\n"}]},"apps":[],"jobName":"paragraph_1550541446104_1898078314","id":"20190219-015726_1390995381","dateCreated":"2019-02-19T01:57:26+0000","dateStarted":"2019-02-19T01:58:57+0000","dateFinished":"2019-02-19T01:58:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1169"},{"text":"%pyspark\nrdd = sc.parallelize([(1,2), (3,4), (3,6)])\nrdd2 = rdd.reduceByKey(lambda a,b: a + b)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T02:05:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 10)]\n"}]},"apps":[],"jobName":"paragraph_1550541522668_-356795427","id":"20190219-015842_1012348127","dateCreated":"2019-02-19T01:58:42+0000","dateStarted":"2019-02-19T02:05:51+0000","dateFinished":"2019-02-19T02:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1170"},{"text":"%pyspark\nrdd = sc.parallelize([(1,'a'), (2,'c'), (1,'b')])\nrdd2 = rdd.sortByKey()\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-02-19T02:06:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"}]},"apps":[],"jobName":"paragraph_1550541938224_1815449770","id":"20190219-020538_1686726193","dateCreated":"2019-02-19T02:05:38+0000","dateStarted":"2019-02-19T02:06:29+0000","dateFinished":"2019-02-19T02:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1171"},{"text":"%pyspark\nrdd2 = rdd.groupByKey()\n","user":"anonymous","dateUpdated":"2019-02-19T02:07:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550541989004_-1998673346","id":"20190219-020629_2046995725","dateCreated":"2019-02-19T02:06:29+0000","dateStarted":"2019-02-19T02:07:25+0000","dateFinished":"2019-02-19T02:07:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1172"},{"text":"%pyspark\nbroadcastVar = sc.broadcast([1, 2, 3]) \nbroadcastVar.value","user":"anonymous","dateUpdated":"2019-02-19T02:11:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1550542025009_296015066","id":"20190219-020705_675793193","dateCreated":"2019-02-19T02:07:05+0000","dateStarted":"2019-02-19T02:11:26+0000","dateFinished":"2019-02-19T02:11:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1173"},{"text":"%pyspark\naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n    global accum\n    accum += x  \n \nrdd.foreach(f) \naccum.value\n","user":"anonymous","dateUpdated":"2019-02-19T02:13:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1550542276578_-774773415","id":"20190219-021116_790039388","dateCreated":"2019-02-19T02:11:16+0000","dateStarted":"2019-02-19T02:13:32+0000","dateFinished":"2019-02-19T02:13:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1174"},{"text":"%sh \n\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.data\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.item\nmv u.data /tmp/\nmv u.item /tmp/\n","user":"anonymous","dateUpdated":"2019-02-19T02:43:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-02-19 02:43:50--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.data\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1979173 (1.9M) [text/plain]\nSaving to: ‘u.data’\n\n     0K .......... .......... .......... .......... ..........  2% 1.98M 1s\n    50K .......... .......... .......... .......... ..........  5% 3.96M 1s\n   100K .......... .......... .......... .......... ..........  7%  111M 0s\n   150K .......... .......... .......... .......... .......... 10%  141M 0s\n   200K .......... .......... .......... .......... .......... 12% 3.94M 0s\n   250K .......... .......... .......... .......... .......... 15%  181M 0s\n   300K .......... .......... .......... .......... .......... 18%  128M 0s\n   350K .......... .......... .......... .......... .......... 20% 4.12M 0s\n   400K .......... .......... .......... .......... .......... 23%  198M 0s\n   450K .......... .......... .......... .......... .......... 25%  157M 0s\n   500K .......... .......... .......... .......... .......... 28%  157M 0s\n   550K .......... .......... .......... .......... .......... 31%  159M 0s\n   600K .......... .......... .......... .......... .......... 33% 4.29M 0s\n   650K .......... .......... .......... .......... .......... 36%  107M 0s\n   700K .......... .......... .......... .......... .......... 38%  183M 0s\n   750K .......... .......... .......... .......... .......... 41%  136M 0s\n   800K .......... .......... .......... .......... .......... 43%  134M 0s\n   850K .......... .......... .......... .......... .......... 46%  154M 0s\n   900K .......... .......... .......... .......... .......... 49%  172M 0s\n   950K .......... .......... .......... .......... .......... 51%  149M 0s\n  1000K .......... .......... .......... .......... .......... 54%  160M 0s\n  1050K .......... .......... .......... .......... .......... 56%  166M 0s\n  1100K .......... .......... .......... .......... .......... 59%  161M 0s\n  1150K .......... .......... .......... .......... .......... 62%  146M 0s\n  1200K .......... .......... .......... .......... .......... 64% 5.65M 0s\n  1250K .......... .......... .......... .......... .......... 67% 68.6M 0s\n  1300K .......... .......... .......... .......... .......... 69% 97.5M 0s\n  1350K .......... .......... .......... .......... .......... 72%  120M 0s\n  1400K .......... .......... .......... .......... .......... 75%  140M 0s\n  1450K .......... .......... .......... .......... .......... 77%  197M 0s\n  1500K .......... .......... .......... .......... .......... 80%  162M 0s\n  1550K .......... .......... .......... .......... .......... 82%  154M 0s\n  1600K .......... .......... .......... .......... .......... 85%  156M 0s\n  1650K .......... .......... .......... .......... .......... 87%  149M 0s\n  1700K .......... .......... .......... .......... .......... 90% 5.22M 0s\n  1750K .......... .......... .......... .......... .......... 93%  130M 0s\n  1800K .......... .......... .......... .......... .......... 95%  118M 0s\n  1850K .......... .......... .......... .......... .......... 98%  815K 0s\n  1900K .......... .......... .......... ..                   100%  526K=0.2s\n\n2019-02-19 02:43:50 (8.39 MB/s) - ‘u.data’ saved [1979173/1979173]\n\n--2019-02-19 02:43:50--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.item\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [text/plain]\nSaving to: ‘u.item’\n\n     0K .......... .......... .......... .......... .......... 21% 1.95M 0s\n    50K .......... .......... .......... .......... .......... 43% 3.95M 0s\n   100K .......... .......... .......... .......... .......... 64%  118M 0s\n   150K .......... .......... .......... .......... .......... 86% 92.9M 0s\n   200K .......... .......... ..........                      100% 2.59M=0.05s\n\n2019-02-19 02:43:50 (4.51 MB/s) - ‘u.item’ saved [236344/236344]\n\n"}]},"apps":[],"jobName":"paragraph_1550542338426_435924104","id":"20190219-021218_198375774","dateCreated":"2019-02-19T02:12:18+0000","dateStarted":"2019-02-19T02:43:50+0000","dateFinished":"2019-02-19T02:43:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1175"},{"text":"%pyspark\nlines = sc.textFile('file:///tmp/u.data')\nlines.take(5)","user":"anonymous","dateUpdated":"2019-02-19T02:44:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['196\\t242\\t3\\t881250949', '186\\t302\\t3\\t891717742', '22\\t377\\t1\\t878887116', '244\\t51\\t2\\t880606923', '166\\t346\\t1\\t886397596']\n"}]},"apps":[],"jobName":"paragraph_1550544052388_-204648354","id":"20190219-024052_127401825","dateCreated":"2019-02-19T02:40:52+0000","dateStarted":"2019-02-19T02:44:12+0000","dateFinished":"2019-02-19T02:44:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1176"},{"text":"%pyspark \nmovies = lines.map(lambda x: (int(x.split()[1]), 1) )\nmovies.take(3)","user":"anonymous","dateUpdated":"2019-02-19T02:47:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(242, 1), (302, 1), (377, 1)]\n"}]},"apps":[],"jobName":"paragraph_1550544122868_699419616","id":"20190219-024202_415948197","dateCreated":"2019-02-19T02:42:02+0000","dateStarted":"2019-02-19T02:47:59+0000","dateFinished":"2019-02-19T02:47:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1177"},{"text":"%pyspark\nmovieCounts  = movies.reduceByKey(lambda x,y : x + y)\nres = movieCounts.sortBy(lambda a: -a[1])\nres.take(3)","user":"anonymous","dateUpdated":"2019-02-19T02:50:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(50, 583), (258, 509), (100, 508)]\n"}]},"apps":[],"jobName":"paragraph_1550544154808_-11349520","id":"20190219-024234_768231555","dateCreated":"2019-02-19T02:42:34+0000","dateStarted":"2019-02-19T02:50:42+0000","dateFinished":"2019-02-19T02:50:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1178"},{"text":"%sh\nhead /tmp/u.item\n","user":"anonymous","dateUpdated":"2019-02-19T02:53:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0\n2|GoldenEye (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n3|Four Rooms (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n4|Get Shorty (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Get%20Shorty%20(1995)|0|1|0|0|0|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n5|Copycat (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Copycat%20(1995)|0|0|0|0|0|0|1|0|1|0|0|0|0|0|0|0|1|0|0\n6|Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)|01-Jan-1995||http://us.imdb.com/Title?Yao+a+yao+yao+dao+waipo+qiao+(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n7|Twelve Monkeys (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Twelve%20Monkeys%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|1|0|0|0\n8|Babe (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Babe%20(1995)|0|0|0|0|1|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n9|Dead Man Walking (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Dead%20Man%20Walking%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n10|Richard III (1995)|22-Jan-1996||http://us.imdb.com/M/title-exact?Richard%20III%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|1|0\n"}]},"apps":[],"jobName":"paragraph_1550544616888_1180260507","id":"20190219-025016_1600687293","dateCreated":"2019-02-19T02:50:16+0000","dateStarted":"2019-02-19T02:53:36+0000","dateFinished":"2019-02-19T02:53:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1179"},{"text":"%pyspark\ndef loadMovieNames():\n    movieNames = {}\n    with open('/tmp/u.item', 'r', encoding = 'latin1') as f:\n        for line in f:\n            fields = line.strip().split('|')\n            movieNames[int(fields[0])] = fields[1]\n    return movieNames\n    \na = loadMovieNames()\nnameDict = sc.broadcast(a)","user":"anonymous","dateUpdated":"2019-02-19T03:01:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550544810656_-1032755514","id":"20190219-025330_238450572","dateCreated":"2019-02-19T02:53:30+0000","dateStarted":"2019-02-19T03:01:37+0000","dateFinished":"2019-02-19T03:01:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1180"},{"text":"%pyspark\nprint(nameDict.value.get(50))","user":"anonymous","dateUpdated":"2019-02-19T03:01:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Star Wars (1977)\n"}]},"apps":[],"jobName":"paragraph_1550544908476_-1111675011","id":"20190219-025508_364592895","dateCreated":"2019-02-19T02:55:08+0000","dateStarted":"2019-02-19T03:01:48+0000","dateFinished":"2019-02-19T03:01:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1181"},{"text":"%pyspark\nres2 = res.map(lambda e: (nameDict.value.get(e[0]), e[1]))\nres2.take(10)\n","user":"anonymous","dateUpdated":"2019-02-19T03:01:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Star Wars (1977)', 583), ('Contact (1997)', 509), ('Fargo (1996)', 508), ('Return of the Jedi (1983)', 507), ('Liar Liar (1997)', 485), ('English Patient, The (1996)', 481), ('Scream (1996)', 478), ('Toy Story (1995)', 452), ('Air Force One (1997)', 431), ('Independence Day (ID4) (1996)', 429)]\n"}]},"apps":[],"jobName":"paragraph_1550545103087_267537070","id":"20190219-025823_753736330","dateCreated":"2019-02-19T02:58:23+0000","dateStarted":"2019-02-19T03:01:50+0000","dateFinished":"2019-02-19T03:01:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1182"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\n","user":"anonymous","dateUpdated":"2019-02-19T03:18:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550545285426_1484591430","id":"20190219-030125_746229599","dateCreated":"2019-02-19T03:01:25+0000","dateStarted":"2019-02-19T03:18:18+0000","dateFinished":"2019-02-19T03:18:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1183"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/ratings.txt\nmv ratings.txt /tmp/","user":"anonymous","dateUpdated":"2019-02-19T03:19:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-02-19 03:19:28--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/ratings.txt\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3791189 (3.6M) [text/plain]\nSaving to: ‘ratings.txt’\n\n     0K .......... .......... .......... .......... ..........  1% 1.90M 2s\n    50K .......... .......... .......... .......... ..........  2% 3.75M 1s\n   100K .......... .......... .......... .......... ..........  4% 82.2M 1s\n   150K .......... .......... .......... .......... ..........  5%  106M 1s\n   200K .......... .......... .......... .......... ..........  6% 3.86M 1s\n   250K .......... .......... .......... .......... ..........  8%  130M 1s\n   300K .......... .......... .......... .......... ..........  9%  150M 1s\n   350K .......... .......... .......... .......... .......... 10%  130M 0s\n   400K .......... .......... .......... .......... .......... 12% 4.11M 0s\n   450K .......... .......... .......... .......... .......... 13% 58.0M 0s\n   500K .......... .......... .......... .......... .......... 14%  104M 0s\n   550K .......... .......... .......... .......... .......... 16%  105M 0s\n   600K .......... .......... .......... .......... .......... 17%  139M 0s\n   650K .......... .......... .......... .......... .......... 18% 3.73M 0s\n   700K .......... .......... .......... .......... .......... 20% 4.39M 0s\n   750K .......... .......... .......... .......... .......... 21% 92.5M 0s\n   800K .......... .......... .......... .......... .......... 22%  124M 0s\n   850K .......... .......... .......... .......... .......... 24%  104M 0s\n   900K .......... .......... .......... .......... .......... 25%  157M 0s\n   950K .......... .......... .......... .......... .......... 27%  134M 0s\n  1000K .......... .......... .......... .......... .......... 28%  149M 0s\n  1050K .......... .......... .......... .......... .......... 29%  168M 0s\n  1100K .......... .......... .......... .......... .......... 31%  125M 0s\n  1150K .......... .......... .......... .......... .......... 32%  136M 0s\n  1200K .......... .......... .......... .......... .......... 33%  188M 0s\n  1250K .......... .......... .......... .......... .......... 35%  158M 0s\n  1300K .......... .......... .......... .......... .......... 36%  144M 0s\n  1350K .......... .......... .......... .......... .......... 37%  118M 0s\n  1400K .......... .......... .......... .......... .......... 39%  149M 0s\n  1450K .......... .......... .......... .......... .......... 40%  189M 0s\n  1500K .......... .......... .......... .......... .......... 41%  178M 0s\n  1550K .......... .......... .......... .......... .......... 43% 6.40M 0s\n  1600K .......... .......... .......... .......... .......... 44% 84.7M 0s\n  1650K .......... .......... .......... .......... .......... 45%  130M 0s\n  1700K .......... .......... .......... .......... .......... 47%  175M 0s\n  1750K .......... .......... .......... .......... .......... 48%  134M 0s\n  1800K .......... .......... .......... .......... .......... 49%  181M 0s\n  1850K .......... .......... .......... .......... .......... 51%  162M 0s\n  1900K .......... .......... .......... .......... .......... 52%  156M 0s\n  1950K .......... .......... .......... .......... .......... 54%  124M 0s\n  2000K .......... .......... .......... .......... .......... 55%  164M 0s\n  2050K .......... .......... .......... .......... .......... 56% 4.86M 0s\n  2100K .......... .......... .......... .......... .......... 58% 41.4M 0s\n  2150K .......... .......... .......... .......... .......... 59% 81.8M 0s\n  2200K .......... .......... .......... .......... .......... 60%  101M 0s\n  2250K .......... .......... .......... .......... .......... 62% 86.3M 0s\n  2300K .......... .......... .......... .......... .......... 63%  107M 0s\n  2350K .......... .......... .......... .......... .......... 64% 90.7M 0s\n  2400K .......... .......... .......... .......... .......... 66%  101M 0s\n  2450K .......... .......... .......... .......... .......... 67%  119M 0s\n  2500K .......... .......... .......... .......... .......... 68%  139M 0s\n  2550K .......... .......... .......... .......... .......... 70% 6.25M 0s\n  2600K .......... .......... .......... .......... .......... 71%  141M 0s\n  2650K .......... .......... .......... .......... .......... 72%  124M 0s\n  2700K .......... .......... .......... .......... .......... 74%  110M 0s\n  2750K .......... .......... .......... .......... .......... 75% 86.4M 0s\n  2800K .......... .......... .......... .......... .......... 76%  153M 0s\n  2850K .......... .......... .......... .......... .......... 78%  178M 0s\n  2900K .......... .......... .......... .......... .......... 79%  155M 0s\n  2950K .......... .......... .......... .......... .......... 81%  140M 0s\n  3000K .......... .......... .......... .......... .......... 82%  154M 0s\n  3050K .......... .......... .......... .......... .......... 83% 4.98M 0s\n  3100K .......... .......... .......... .......... .......... 85%  119M 0s\n  3150K .......... .......... .......... .......... .......... 86% 76.3M 0s\n  3200K .......... .......... .......... .......... .......... 87%  138M 0s\n  3250K .......... .......... .......... .......... .......... 89%  122M 0s\n  3300K .......... .......... .......... .......... .......... 90%  139M 0s\n  3350K .......... .......... .......... .......... .......... 91%  114M 0s\n  3400K .......... .......... .......... .......... .......... 93%  143M 0s\n  3450K .......... .......... .......... .......... .......... 94%  140M 0s\n  3500K .......... .......... .......... .......... .......... 95%  121M 0s\n  3550K .......... .......... .......... .......... .......... 97% 5.23M 0s\n  3600K .......... .......... .......... .......... .......... 98%  119M 0s\n  3650K .......... .......... .......... .......... .......... 99%  120M 0s\n  3700K ..                                                    100% 4450G=0.2s\n\n2019-02-19 03:19:28 (22.9 MB/s) - ‘ratings.txt’ saved [3791189/3791189]\n\n"}]},"apps":[],"jobName":"paragraph_1550546298003_1175095663","id":"20190219-031818_1106984185","dateCreated":"2019-02-19T03:18:18+0000","dateStarted":"2019-02-19T03:19:28+0000","dateFinished":"2019-02-19T03:19:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1184"},{"text":"%pyspark\ndata_file = \"file:///tmp/ratings.txt\"\nraw_data = sc.textFile(data_file)\nraw_data.take(3)\n","user":"anonymous","dateUpdated":"2019-02-19T03:24:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['userid::itemid::rating', '0::0::4', '0::1::5']\n"}]},"apps":[],"jobName":"paragraph_1550546368208_1974127183","id":"20190219-031928_197302734","dateCreated":"2019-02-19T03:19:28+0000","dateStarted":"2019-02-19T03:24:44+0000","dateFinished":"2019-02-19T03:24:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1185"},{"text":"%pyspark\nheader = raw_data.first()\nheader","user":"anonymous","dateUpdated":"2019-02-19T03:24:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'userid::itemid::rating'\n"}]},"apps":[],"jobName":"paragraph_1550546430758_1224110371","id":"20190219-032030_1981947652","dateCreated":"2019-02-19T03:20:30+0000","dateStarted":"2019-02-19T03:24:47+0000","dateFinished":"2019-02-19T03:24:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1186"},{"text":"%pyspark\nskip_data = raw_data.filter(lambda line: line != header)\n","user":"anonymous","dateUpdated":"2019-02-19T03:24:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550546482998_-1216859245","id":"20190219-032122_1191186237","dateCreated":"2019-02-19T03:21:22+0000","dateStarted":"2019-02-19T03:24:57+0000","dateFinished":"2019-02-19T03:24:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1187"},{"text":"%pyspark\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:25:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['0::0::4', '0::1::5', '0::7495::3']\n"}]},"apps":[],"jobName":"paragraph_1550546547522_-1394705182","id":"20190219-032227_1472616579","dateCreated":"2019-02-19T03:22:27+0000","dateStarted":"2019-02-19T03:25:01+0000","dateFinished":"2019-02-19T03:25:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1188"},{"text":"%pyspark\ncsv_data = skip_data.map(lambda l: l.split(\"::\"))\ncsv_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:26:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['0', '0', '4'], ['0', '1', '5'], ['0', '7495', '3']]\n"}]},"apps":[],"jobName":"paragraph_1550546632221_657099406","id":"20190219-032352_1534638824","dateCreated":"2019-02-19T03:23:52+0000","dateStarted":"2019-02-19T03:26:35+0000","dateFinished":"2019-02-19T03:26:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1189"},{"text":"%pyspark\nfrom pyspark.sql import Row\n\nrow_data = csv_data.map(lambda p: Row(\n    userid=p[0], \n    itemid=p[1],\n    rating=int(p[2])\n    )\n)\nrow_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:27:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0')]\n"}]},"apps":[],"jobName":"paragraph_1550546725083_-1543943427","id":"20190219-032525_1718362561","dateCreated":"2019-02-19T03:25:25+0000","dateStarted":"2019-02-19T03:26:48+0000","dateFinished":"2019-02-19T03:26:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1190"},{"text":"%pyspark\ndf = sqlContext.createDataFrame(row_data)\ndf.registerTempTable(\"ratings\")\n","user":"anonymous","dateUpdated":"2019-02-19T03:27:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550546765671_1715157236","id":"20190219-032605_1836020947","dateCreated":"2019-02-19T03:26:05+0000","dateStarted":"2019-02-19T03:27:38+0000","dateFinished":"2019-02-19T03:27:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1191"},{"text":"%pyspark\ndf.take(5)","user":"anonymous","dateUpdated":"2019-02-19T03:28:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(itemid='0', rating=4, userid='0'), Row(itemid='1', rating=5, userid='0'), Row(itemid='7495', rating=3, userid='0'), Row(itemid='7496', rating=5, userid='0'), Row(itemid='7497', rating=5, userid='0')]\n"}]},"apps":[],"jobName":"paragraph_1550546858480_-1776900402","id":"20190219-032738_371087607","dateCreated":"2019-02-19T03:27:38+0000","dateStarted":"2019-02-19T03:27:55+0000","dateFinished":"2019-02-19T03:27:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1192"},{"text":"%pyspark\ndf.show(5)","user":"anonymous","dateUpdated":"2019-02-19T03:28:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n|  7496|     5|     0|\n|  7497|     5|     0|\n+------+------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550546875859_128022051","id":"20190219-032755_1119592438","dateCreated":"2019-02-19T03:27:55+0000","dateStarted":"2019-02-19T03:28:14+0000","dateFinished":"2019-02-19T03:28:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1193"},{"text":"%pyspark\ndf.select(\"userid\", \"rating\").groupBy(\"userid\").avg().show(5)\n","user":"anonymous","dateUpdated":"2019-02-19T03:30:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------------------+\n|userid|       avg(rating)|\n+------+------------------+\n|   296|3.7885714285714287|\n|   467| 3.257575757575758|\n|   675| 3.193661971830986|\n|   691|3.6065573770491803|\n|   829|3.9507042253521125|\n+------+------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550546894531_-1394414023","id":"20190219-032814_393026848","dateCreated":"2019-02-19T03:28:14+0000","dateStarted":"2019-02-19T03:30:17+0000","dateFinished":"2019-02-19T03:30:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1194"},{"text":"%pyspark\ndf.select(\"userid\", \"rating\").groupBy(\"userid\").sum().show(5)","user":"anonymous","dateUpdated":"2019-02-19T03:30:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----------+\n|userid|sum(rating)|\n+------+-----------+\n|   296|        663|\n|   467|        215|\n|   675|        907|\n|   691|        220|\n|   829|        561|\n+------+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550546991584_-1960658779","id":"20190219-032951_853375010","dateCreated":"2019-02-19T03:29:51+0000","dateStarted":"2019-02-19T03:30:27+0000","dateFinished":"2019-02-19T03:30:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1195"},{"text":"%pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-02-19T03:31:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- itemid: string (nullable = true)\n |-- rating: long (nullable = true)\n |-- userid: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1550547026991_-240168967","id":"20190219-033026_764441339","dateCreated":"2019-02-19T03:30:26+0000","dateStarted":"2019-02-19T03:30:48+0000","dateFinished":"2019-02-19T03:30:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1196"},{"text":"%pyspark\nratings_data = sqlContext.sql(\"\"\"\n    SELECT userid,avg(rating) from ratings group by userid\n\"\"\")\nratings_data.show()\n","user":"anonymous","dateUpdated":"2019-02-19T03:32:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------------------+\n|userid|       avg(rating)|\n+------+------------------+\n|   296|3.7885714285714287|\n|   467| 3.257575757575758|\n|   675| 3.193661971830986|\n|   691|3.6065573770491803|\n|   829|3.9507042253521125|\n|  1090| 3.398876404494382|\n|  1159|               4.4|\n|  1436| 4.101167315175097|\n|  1512| 3.466666666666667|\n|  1572|             3.895|\n|  2069|3.8285714285714287|\n|  2088|3.7857142857142856|\n|  2136|               3.6|\n|  2162| 2.857142857142857|\n|  2294|               3.0|\n|  2904| 4.222222222222222|\n|  3210| 4.229166666666667|\n|  3414| 4.416666666666667|\n|  3606|               4.0|\n|  3959| 4.538461538461538|\n+------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550547048681_534345893","id":"20190219-033048_1244271939","dateCreated":"2019-02-19T03:30:48+0000","dateStarted":"2019-02-19T03:32:46+0000","dateFinished":"2019-02-19T03:32:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1197"},{"text":"%md\n# 找出最受歡迎的電影","user":"anonymous","dateUpdated":"2019-02-19T03:38:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>找出最受歡迎的電影</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1550547166301_-646484587","id":"20190219-033246_1972691460","dateCreated":"2019-02-19T03:32:46+0000","dateStarted":"2019-02-19T03:35:40+0000","dateFinished":"2019-02-19T03:35:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1198"},{"text":"%pyspark\nratings = sc.textFile('file:/tmp/u.data', 4)\nratings.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:37:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['196\\t242\\t3\\t881250949', '186\\t302\\t3\\t891717742', '22\\t377\\t1\\t878887116']\n"}]},"apps":[],"jobName":"paragraph_1550547311182_1942706945","id":"20190219-033511_755982031","dateCreated":"2019-02-19T03:35:11+0000","dateStarted":"2019-02-19T03:37:03+0000","dateFinished":"2019-02-19T03:37:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1199"},{"text":"%pyspark\nratings_data = ratings.map(lambda l:l.split())\n\nratings_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:37:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['196', '242', '3', '881250949'], ['186', '302', '3', '891717742'], ['22', '377', '1', '878887116']]\n"}]},"apps":[],"jobName":"paragraph_1550547423791_-2085108341","id":"20190219-033703_2145081602","dateCreated":"2019-02-19T03:37:03+0000","dateStarted":"2019-02-19T03:37:50+0000","dateFinished":"2019-02-19T03:37:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1200"},{"text":"%pyspark\nratings_row_data = ratings_data.map(lambda p: \n    Row( userid=p[0], movieid=p[1], rating=int(p[2]) )\n)\n\nratings_row_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:38:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(movieid='242', rating=3, userid='196'), Row(movieid='302', rating=3, userid='186'), Row(movieid='377', rating=1, userid='22')]\n"}]},"apps":[],"jobName":"paragraph_1550547470750_54172164","id":"20190219-033750_1226318342","dateCreated":"2019-02-19T03:37:50+0000","dateStarted":"2019-02-19T03:38:18+0000","dateFinished":"2019-02-19T03:38:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1201"},{"text":"%pyspark\ndf = sqlContext.createDataFrame(ratings_row_data)\ndf.registerTempTable(\"ratings\")\n","user":"anonymous","dateUpdated":"2019-02-19T03:39:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550547488841_1840408066","id":"20190219-033808_946918777","dateCreated":"2019-02-19T03:38:08+0000","dateStarted":"2019-02-19T03:39:06+0000","dateFinished":"2019-02-19T03:39:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1202"},{"text":"%pyspark\nmovies = sc.textFile('file:///tmp/u.item', 4)\n\nmovies_data = movies.map(lambda l:l.split('|'))\nmovies_data.take(3)\n","user":"anonymous","dateUpdated":"2019-02-19T03:40:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['1', 'Toy Story (1995)', '01-Jan-1995', '', 'http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)', '0', '0', '0', '1', '1', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'], ['2', 'GoldenEye (1995)', '01-Jan-1995', '', 'http://us.imdb.com/M/title-exact?GoldenEye%20(1995)', '0', '1', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0'], ['3', 'Four Rooms (1995)', '01-Jan-1995', '', 'http://us.imdb.com/M/title-exact?Four%20Rooms%20(1995)', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0']]\n"}]},"apps":[],"jobName":"paragraph_1550547528071_-1647294741","id":"20190219-033848_629889965","dateCreated":"2019-02-19T03:38:48+0000","dateStarted":"2019-02-19T03:40:02+0000","dateFinished":"2019-02-19T03:40:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1203"},{"text":"%pyspark\nmovies_row_data = movies_data.map(lambda p: \n    Row(movieid=p[0], moviename=p[1] )\n)\nmovies_row_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T03:40:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(movieid='1', moviename='Toy Story (1995)'), Row(movieid='2', moviename='GoldenEye (1995)'), Row(movieid='3', moviename='Four Rooms (1995)')]\n"}]},"apps":[],"jobName":"paragraph_1550547585247_829626733","id":"20190219-033945_181689429","dateCreated":"2019-02-19T03:39:45+0000","dateStarted":"2019-02-19T03:40:35+0000","dateFinished":"2019-02-19T03:40:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1204"},{"text":"%pyspark\nmovies_df = sqlContext.createDataFrame(movies_row_data)\nmovies_df.registerTempTable(\"movies\")\n","user":"anonymous","dateUpdated":"2019-02-19T03:41:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550547635500_1944521776","id":"20190219-034035_364787999","dateCreated":"2019-02-19T03:40:35+0000","dateStarted":"2019-02-19T03:41:08+0000","dateFinished":"2019-02-19T03:41:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1205"},{"text":"%pyspark\nbest_movies = sqlContext.sql(\"\"\"\n     SELECT moviename,avg(rating) as avg_rating, count(1) as cnt  from movies inner join ratings on ratings.movieid = movies.movieid group by moviename order by  cnt  desc limit 10\n\"\"\")\nbest_movies.show(5)\n","user":"anonymous","dateUpdated":"2019-02-19T03:42:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+---+\n|           moviename|        avg_rating|cnt|\n+--------------------+------------------+---+\n|    Star Wars (1977)|4.3584905660377355|583|\n|      Contact (1997)|3.8035363457760316|509|\n|        Fargo (1996)| 4.155511811023622|508|\n|Return of the Jed...| 4.007889546351085|507|\n|    Liar Liar (1997)| 3.156701030927835|485|\n+--------------------+------------------+---+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550547668451_-2043369925","id":"20190219-034108_364523348","dateCreated":"2019-02-19T03:41:08+0000","dateStarted":"2019-02-19T03:42:52+0000","dateFinished":"2019-02-19T03:42:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1206"},{"text":"%md\n# 機器學習","user":"anonymous","dateUpdated":"2019-02-19T05:46:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550547721490_1124880736","id":"20190219-034201_5736735","dateCreated":"2019-02-19T03:42:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1207","dateFinished":"2019-02-19T05:46:48+0000","dateStarted":"2019-02-19T05:46:48+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>機器學習</h1>\n</div>"}]}},{"text":"%sh \nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/churnTrain.csv\n\nmv churnTrain.csv /tmp/\n","user":"anonymous","dateUpdated":"2019-02-19T05:46:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555146870_1425470474","id":"20190219-054546_1731291467","dateCreated":"2019-02-19T05:45:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4707","dateFinished":"2019-02-19T05:46:00+0000","dateStarted":"2019-02-19T05:46:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-02-19 05:46:00--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/churnTrain.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 356734 (348K) [text/plain]\nSaving to: ‘churnTrain.csv’\n\n     0K .......... .......... .......... .......... .......... 14% 1.99M 0s\n    50K .......... .......... .......... .......... .......... 28% 4.00M 0s\n   100K .......... .......... .......... .......... .......... 43% 83.7M 0s\n   150K .......... .......... .......... .......... .......... 57%  116M 0s\n   200K .......... .......... .......... .......... .......... 71% 4.08M 0s\n   250K .......... .......... .......... .......... .......... 86%  146M 0s\n   300K .......... .......... .......... .......... ........  100%  146M=0.05s\n\n2019-02-19 05:46:00 (6.75 MB/s) - ‘churnTrain.csv’ saved [356734/356734]\n\n"}]}},{"text":"%pyspark\nraw_data = sc.textFile(\"file:///tmp/churnTrain.csv\")\nraw_data.take(3)\n","user":"anonymous","dateUpdated":"2019-02-19T06:22:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555160336_-1518042502","id":"20190219-054600_1356024478","dateCreated":"2019-02-19T05:46:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4781","dateFinished":"2019-02-19T06:22:18+0000","dateStarted":"2019-02-19T06:22:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['\"\",\"state\",\"account_length\",\"area_code\",\"international_plan\",\"voice_mail_plan\",\"number_vmail_messages\",\"total_day_minutes\",\"total_day_calls\",\"total_day_charge\",\"total_eve_minutes\",\"total_eve_calls\",\"total_eve_charge\",\"total_night_minutes\",\"total_night_calls\",\"total_night_charge\",\"total_intl_minutes\",\"total_intl_calls\",\"total_intl_charge\",\"number_customer_service_calls\",\"churn\"', '\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"', '\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"']\n"}]}},{"text":"%pyspark\nheader = raw_data.first()\nskip_data = raw_data.filter(lambda e: e!= header)\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-02-19T06:22:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555194413_1908607823","id":"20190219-054634_1806064804","dateCreated":"2019-02-19T05:46:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4886","dateFinished":"2019-02-19T06:22:21+0000","dateStarted":"2019-02-19T06:22:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"', '\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"', '\"3\",\"NJ\",137,\"area_code_415\",\"no\",\"no\",0,243.4,114,41.38,121.2,110,10.3,162.6,104,7.32,12.2,5,3.29,0,\"no\"']\n"}]}},{"text":"%pyspark\nsplitlines = skip_data.map(lambda l: l.split(\",\"))\nsplitlines.take(3)","user":"anonymous","dateUpdated":"2019-02-19T06:22:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555289846_-1979589585","id":"20190219-054809_1150089613","dateCreated":"2019-02-19T05:48:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4970","dateFinished":"2019-02-19T06:22:25+0000","dateStarted":"2019-02-19T06:22:25+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['\"1\"', '\"KS\"', '128', '\"area_code_415\"', '\"no\"', '\"yes\"', '25', '265.1', '110', '45.07', '197.4', '99', '16.78', '244.7', '91', '11.01', '10', '3', '2.7', '1', '\"no\"'], ['\"2\"', '\"OH\"', '107', '\"area_code_415\"', '\"no\"', '\"yes\"', '26', '161.6', '123', '27.47', '195.5', '103', '16.62', '254.4', '103', '11.45', '13.7', '3', '3.7', '1', '\"no\"'], ['\"3\"', '\"NJ\"', '137', '\"area_code_415\"', '\"no\"', '\"no\"', '0', '243.4', '114', '41.38', '121.2', '110', '10.3', '162.6', '104', '7.32', '12.2', '5', '3.29', '0', '\"no\"']]\n"}]}},{"text":"%pyspark\ndef parseLine(col):\n    features = []\n    churn = col[-1]\n    international = 0 if col[4] == '\"no\"' else 1\n    voice = 0 if col[5] == '\"no\"'  else 1\n    label = 0 if churn == '\"no\"' else 1\n    features.append(international)\n    features.append(voice)\n    features += col[6:-1]\n    return LabeledPoint(label, Vectors.dense(features))\n","user":"anonymous","dateUpdated":"2019-02-19T06:22:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555346174_542146651","id":"20190219-054906_867807578","dateCreated":"2019-02-19T05:49:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5051","dateFinished":"2019-02-19T06:22:35+0000","dateStarted":"2019-02-19T06:22:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.mllib.linalg import Vectors\ntrainData = splitlines.map(parseLine)\ntrainData.take(30)\n","user":"anonymous","dateUpdated":"2019-02-19T06:22:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555589383_-609642126","id":"20190219-055309_1411834591","dateCreated":"2019-02-19T05:53:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5123","dateFinished":"2019-02-19T06:22:37+0000","dateStarted":"2019-02-19T06:22:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[LabeledPoint(0.0, [0.0,1.0,25.0,265.1,110.0,45.07,197.4,99.0,16.78,244.7,91.0,11.01,10.0,3.0,2.7,1.0]), LabeledPoint(0.0, [0.0,1.0,26.0,161.6,123.0,27.47,195.5,103.0,16.62,254.4,103.0,11.45,13.7,3.0,3.7,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,243.4,114.0,41.38,121.2,110.0,10.3,162.6,104.0,7.32,12.2,5.0,3.29,0.0]), LabeledPoint(0.0, [1.0,0.0,0.0,299.4,71.0,50.9,61.9,88.0,5.26,196.9,89.0,8.86,6.6,7.0,1.78,2.0]), LabeledPoint(0.0, [1.0,0.0,0.0,166.7,113.0,28.34,148.3,122.0,12.61,186.9,121.0,8.41,10.1,3.0,2.73,3.0]), LabeledPoint(0.0, [1.0,0.0,0.0,223.4,98.0,37.98,220.6,101.0,18.75,203.9,118.0,9.18,6.3,6.0,1.7,0.0]), LabeledPoint(0.0, [0.0,1.0,24.0,218.2,88.0,37.09,348.5,108.0,29.62,212.6,118.0,9.57,7.5,7.0,2.03,3.0]), LabeledPoint(0.0, [1.0,0.0,0.0,157.0,79.0,26.69,103.1,94.0,8.76,211.8,96.0,9.53,7.1,6.0,1.92,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,184.5,97.0,31.37,351.6,80.0,29.89,215.8,90.0,9.71,8.7,4.0,2.35,1.0]), LabeledPoint(0.0, [1.0,1.0,37.0,258.6,84.0,43.96,222.0,111.0,18.87,326.4,97.0,14.69,11.2,5.0,3.02,0.0]), LabeledPoint(1.0, [0.0,0.0,0.0,129.1,137.0,21.95,228.5,83.0,19.42,208.8,111.0,9.4,12.7,6.0,3.43,4.0]), LabeledPoint(0.0, [0.0,0.0,0.0,187.7,127.0,31.91,163.4,148.0,13.89,196.0,94.0,8.82,9.1,5.0,2.46,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,128.8,96.0,21.9,104.9,71.0,8.92,141.1,128.0,6.35,11.2,2.0,3.02,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,156.6,88.0,26.62,247.6,75.0,21.05,192.3,115.0,8.65,12.3,5.0,3.32,3.0]), LabeledPoint(0.0, [0.0,0.0,0.0,120.7,70.0,20.52,307.2,76.0,26.11,203.0,99.0,9.14,13.1,6.0,3.54,4.0]), LabeledPoint(1.0, [0.0,0.0,0.0,332.9,67.0,56.59,317.8,97.0,27.01,160.6,128.0,7.23,5.4,9.0,1.46,4.0]), LabeledPoint(0.0, [0.0,1.0,27.0,196.4,139.0,33.39,280.9,90.0,23.88,89.3,75.0,4.02,13.8,4.0,3.73,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,190.7,114.0,32.42,218.2,111.0,18.55,129.6,121.0,5.83,8.1,3.0,2.19,3.0]), LabeledPoint(0.0, [0.0,1.0,33.0,189.7,66.0,32.25,212.8,65.0,18.09,165.7,108.0,7.46,10.0,5.0,2.7,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,224.4,90.0,38.15,159.5,88.0,13.56,192.8,74.0,8.68,13.0,2.0,3.51,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,155.1,117.0,26.37,239.7,93.0,20.37,208.8,133.0,9.4,10.6,4.0,2.86,0.0]), LabeledPoint(1.0, [0.0,0.0,0.0,62.4,89.0,10.61,169.9,121.0,14.44,209.6,64.0,9.43,5.7,6.0,1.54,5.0]), LabeledPoint(0.0, [0.0,0.0,0.0,183.0,112.0,31.11,72.9,99.0,6.2,181.8,78.0,8.18,9.5,19.0,2.57,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,110.4,103.0,18.77,137.3,102.0,11.67,189.6,105.0,8.53,7.7,6.0,2.08,2.0]), LabeledPoint(0.0, [0.0,0.0,0.0,81.1,86.0,13.79,245.2,72.0,20.84,237.0,115.0,10.67,10.3,2.0,2.78,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,124.3,76.0,21.13,277.1,112.0,23.55,250.7,115.0,11.28,15.5,5.0,4.19,3.0]), LabeledPoint(0.0, [0.0,1.0,39.0,213.0,115.0,36.21,191.1,112.0,16.24,182.7,115.0,8.22,9.5,3.0,2.57,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,134.3,73.0,22.83,155.5,100.0,13.22,102.1,68.0,4.59,14.7,4.0,3.97,3.0]), LabeledPoint(0.0, [0.0,0.0,0.0,190.0,109.0,32.3,258.2,84.0,21.95,181.5,102.0,8.17,6.3,6.0,1.7,0.0]), LabeledPoint(0.0, [0.0,0.0,0.0,119.3,117.0,20.28,215.1,109.0,18.28,178.7,90.0,8.04,11.1,1.0,3.0,1.0])]\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.tree import DecisionTree\nmodel = DecisionTree.trainClassifier(trainData, numClasses=2, categoricalFeaturesInfo={},impurity='gini', maxDepth=5)\n","user":"anonymous","dateUpdated":"2019-02-19T06:22:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550555642876_-1859813896","id":"20190219-055402_344685140","dateCreated":"2019-02-19T05:54:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5179","dateFinished":"2019-02-19T06:22:56+0000","dateStarted":"2019-02-19T06:22:55+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nmodel.toDebugString()","user":"anonymous","dateUpdated":"2019-02-19T06:22:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556168612_1577129415","id":"20190219-060248_2083994156","dateCreated":"2019-02-19T06:02:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5409","dateFinished":"2019-02-19T06:22:59+0000","dateStarted":"2019-02-19T06:22:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'DecisionTreeModel classifier of depth 5 with 57 nodes\\n  If (feature 3 <= 264.7)\\n   If (feature 15 <= 3.0)\\n    If (feature 0 <= 0.0)\\n     If (feature 3 <= 221.4)\\n      If (feature 4 <= 120.0)\\n       Predict: 0.0\\n      Else (feature 4 > 120.0)\\n       Predict: 0.0\\n     Else (feature 3 > 221.4)\\n      If (feature 6 <= 259.8)\\n       Predict: 0.0\\n      Else (feature 6 > 259.8)\\n       Predict: 1.0\\n    Else (feature 0 > 0.0)\\n     If (feature 13 <= 2.0)\\n      Predict: 1.0\\n     Else (feature 13 > 2.0)\\n      If (feature 12 <= 12.9)\\n       Predict: 0.0\\n      Else (feature 12 > 12.9)\\n       Predict: 1.0\\n   Else (feature 15 > 3.0)\\n    If (feature 3 <= 161.3)\\n     If (feature 6 <= 230.2)\\n      If (feature 9 <= 252.7)\\n       Predict: 1.0\\n      Else (feature 9 > 252.7)\\n       Predict: 1.0\\n     Else (feature 6 > 230.2)\\n      If (feature 3 <= 138.5)\\n       Predict: 1.0\\n      Else (feature 3 > 138.5)\\n       Predict: 0.0\\n    Else (feature 3 > 161.3)\\n     If (feature 6 <= 156.0)\\n      If (feature 3 <= 193.3)\\n       Predict: 1.0\\n      Else (feature 3 > 193.3)\\n       Predict: 0.0\\n     Else (feature 6 > 156.0)\\n      If (feature 3 <= 179.4)\\n       Predict: 0.0\\n      Else (feature 3 > 179.4)\\n       Predict: 0.0\\n  Else (feature 3 > 264.7)\\n   If (feature 1 <= 0.0)\\n    If (feature 6 <= 184.9)\\n     If (feature 9 <= 213.3)\\n      If (feature 3 <= 280.4)\\n       Predict: 0.0\\n      Else (feature 3 > 280.4)\\n       Predict: 0.0\\n     Else (feature 9 > 213.3)\\n      If (feature 6 <= 123.5)\\n       Predict: 0.0\\n      Else (feature 6 > 123.5)\\n       Predict: 1.0\\n    Else (feature 6 > 184.9)\\n     If (feature 9 <= 123.2)\\n      If (feature 10 <= 103.0)\\n       Predict: 1.0\\n      Else (feature 10 > 103.0)\\n       Predict: 0.0\\n     Else (feature 9 > 123.2)\\n      If (feature 6 <= 201.3)\\n       Predict: 1.0\\n      Else (feature 6 > 201.3)\\n       Predict: 1.0\\n   Else (feature 1 > 0.0)\\n    If (feature 0 <= 0.0)\\n     If (feature 6 <= 259.8)\\n      Predict: 0.0\\n     Else (feature 6 > 259.8)\\n      If (feature 7 <= 103.0)\\n       Predict: 0.0\\n      Else (feature 7 > 103.0)\\n       Predict: 1.0\\n    Else (feature 0 > 0.0)\\n     If (feature 3 <= 280.4)\\n      Predict: 1.0\\n     Else (feature 3 > 280.4)\\n      If (feature 9 <= 229.8)\\n       Predict: 0.0\\n      Else (feature 9 > 229.8)\\n       Predict: 1.0\\n'\n"}]}},{"text":"%pyspark\nhead = trainData.first()\nmodel.predict(head.features)","user":"anonymous","dateUpdated":"2019-02-19T06:23:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556252995_-455190896","id":"20190219-060412_1218626603","dateCreated":"2019-02-19T06:04:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5476","dateFinished":"2019-02-19T06:23:06+0000","dateStarted":"2019-02-19T06:23:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.0\n"}]}},{"text":"%pyspark\npredictions = model.predict(trainData.map(lambda p: p.features))\n","user":"anonymous","dateUpdated":"2019-02-19T06:23:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556276508_708151860","id":"20190219-060436_860964333","dateCreated":"2019-02-19T06:04:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5548","dateFinished":"2019-02-19T06:23:09+0000","dateStarted":"2019-02-19T06:23:09+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nlabels_and_preds = trainData.map(lambda p: p.label).zip(predictions)\n\n","user":"anonymous","dateUpdated":"2019-02-19T06:23:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556380294_-1210701463","id":"20190219-060620_206235501","dateCreated":"2019-02-19T06:06:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5653","dateFinished":"2019-02-19T06:23:13+0000","dateStarted":"2019-02-19T06:23:13+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nlabels_and_preds.take(30)","user":"anonymous","dateUpdated":"2019-02-19T06:23:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550557244615_1860424434","id":"20190219-062044_1346085643","dateCreated":"2019-02-19T06:20:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6399","dateFinished":"2019-02-19T06:23:16+0000","dateStarted":"2019-02-19T06:23:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (1.0, 1.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 1.0), (1.0, 1.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (1.0, 1.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0)]\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import BinaryClassificationMetrics\n\nmetrics = BinaryClassificationMetrics(labels_and_preds)\n\nprint(\"Area under PR = %s\" % metrics.areaUnderPR)\nprint(\"Area under ROC = %s\" % metrics.areaUnderROC)\n","user":"anonymous","dateUpdated":"2019-02-19T06:23:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556790198_-1440394388","id":"20190219-061310_891318603","dateCreated":"2019-02-19T06:13:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6259","dateFinished":"2019-02-19T06:23:28+0000","dateStarted":"2019-02-19T06:23:27+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Area under PR = 0.8207426929355243\nArea under ROC = 0.9335515176359455\n"}]}},{"text":"","user":"anonymous","dateUpdated":"2019-02-19T06:14:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550556440783_1319330684","id":"20190219-060720_1659852745","dateCreated":"2019-02-19T06:07:20+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5822"}],"name":"Demo20190119","id":"2E473YN1B","angularObjects":{"2E433XPSK:shared_process":[],"2E6KRDRZA:shared_process":[],"2E4X2KNF6:shared_process":[],"2E6RTQP1M:shared_process":[],"2E3TA54GW:shared_process":[],"2E4Z95EUH:shared_process":[],"2E4C248JR:shared_process":[],"2E4XRYUW3:shared_process":[],"2E5QM9RV3:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}